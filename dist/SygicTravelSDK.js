!(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("SygicTravelSDK",[],t):"object"==typeof exports?exports.SygicTravelSDK=t():e.SygicTravelSDK=t()})("undefined"!=typeof self?self:this,(function(){return (function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=36)})([(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38);t.KiwiApi=r;var i=n(57);t.SsoApi=i;var o=n(58);t.StApi=o;var a=n(11);t.ApiResponse=a.ApiResponse}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(69);t.calculateLocationsBounds=r.calculateLocationsBounds,t.getZoomFromBounds=r.getZoomFromBounds,t.isLocationInBounds=r.isLocationInBounds;var i=n(27);t.locationToCanvasCoordinate=i.locationToCanvasCoordinate,t.locationToTileCoordinate=i.locationToTileCoordinate,t.normalizeLng=i.normalizeLng;var o=n(70);t.boundsToMapTileKeys=o.boundsToMapTileKeys,t.locationToMapTileKey=o.locationToMapTileKey;var a=n(71);t.getDistance=a.getDistance,t.EARTH_RADIUS=a.EARTH_RADIUS}),(function(e,t,n){"use strict";function r(e){return"[object Array]"===l.call(e)}function i(e){return null!==e&&"object"==typeof e}function o(e){return"[object Function]"===l.call(e)}function a(e,t){if(null!==e&&void 0!==e)if("object"!=typeof e&&(e=[e]),r(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}function s(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=s(t[n],e):t[n]=e}for(var t={},n=0,r=arguments.length;n<r;n++)a(arguments[n],e);return t}var u=n(21),c=n(40),l=Object.prototype.toString;e.exports={isArray:r,isArrayBuffer:function(e){return"[object ArrayBuffer]"===l.call(e)},isBuffer:c,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:i,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===l.call(e)},isFile:function(e){return"[object File]"===l.call(e)},isBlob:function(e){return"[object Blob]"===l.call(e)},isFunction:o,isStream:function(e){return i(e)&&o(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:a,merge:s,extend:function(e,t,n){return a(t,(function(t,r){e[r]=n&&"function"==typeof t?u(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}}),(function(e,t,n){var r,i;!(function(o){var a=function(e,t,n){if(!p(t)||h(t)||v(t)||y(t)||f(t))return t;var r,i=0,o=0;if(d(t))for(r=[],o=t.length;i<o;i++)r.push(a(e,t[i],n));else{r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[e(s,n)]=a(e,t[s],n))}return r},s=function(e){return g(e)?e:(e=e.replace(/[\-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))).substr(0,1).toLowerCase()+e.substr(1)},u=function(e){var t=s(e);return t.substr(0,1).toUpperCase()+t.substr(1)},c=function(e,t){return (function(e,t){var n=(t=t||{}).separator||"_",r=t.split||/(?=[A-Z])/;return e.split(r).join(n)})(e,t).toLowerCase()},l=Object.prototype.toString,f=function(e){return"function"==typeof e},p=function(e){return e===Object(e)},d=function(e){return"[object Array]"==l.call(e)},h=function(e){return"[object Date]"==l.call(e)},v=function(e){return"[object RegExp]"==l.call(e)},y=function(e){return"[object Boolean]"==l.call(e)},g=function(e){return(e-=0)==e},b=function(e,t){var n=t&&"process"in t?t.process:t;return"function"!=typeof n?e:function(t,r){return n(t,e,r)}},w={camelize:s,decamelize:c,pascalize:u,depascalize:c,camelizeKeys:function(e,t){return a(b(s,t),e)},decamelizeKeys:function(e,t){return a(b(c,t),e,t)},pascalizeKeys:function(e,t){return a(b(u,t),e)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};void 0===(i="function"==typeof(r=w)?r.call(t,n,t,e):r)||(e.exports=i)})()}),(function(e,t,n){"use strict";function r(){return o(this,void 0,void 0,(function(){var e,t,n;return a(this,(function(r){switch(r.label){case 0:return[4,c.getUserSession()];case 1:return e=r.sent(),t=new Date,e&&e.refreshToken&&(t.getTime()>e.suggestedRefreshTimestamp||!e.suggestedRefreshTimestamp)?[4,c.getSessionWithRefreshToken(e.refreshToken)]:[3,3];case 2:"OK"===(n=r.sent()).code&&(i(n.session),e=n.session),r.label=3;case 3:return[2,e]}}))}))}function i(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,s.userCache.reset()];case 1:return t.sent(),[4,s.favoritesCache.reset()];case 2:return t.sent(),[4,s.tripsDetailedCache.reset()];case 3:return t.sent(),u.reset(),[4,c.setUserSession(e)];case 4:return t.sent(),[2]}}))}))}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(9),u=n(16),c=n(82);t.getUserSession=r,t.getUserSettings=function(){return o(this,void 0,void 0,(function(){return a(this,(function(e){return[2,c.getUserSettings()]}))}))},t.updateUserSettings=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){return[2,c.updateUserSettings(e)]}))}))},t.setUserSession=i,t.handleSettingsChange=function(){return o(this,void 0,void 0,(function(){return a(this,(function(e){return[2,c.handleSettingsChange()]}))}))},t.loginUserWithDeviceId=function(e,t){return o(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return[4,c.getSessionWithDeviceId(e,t)];case 1:return"OK"===(n=r.sent()).code&&i(n.session),[2,n.code]}}))}))},t.loginUserWithPassword=function(e,t,n,r){return o(this,void 0,void 0,(function(){var o;return a(this,(function(a){switch(a.label){case 0:return[4,c.getSessionWithPassword(e,t,n,r)];case 1:return"OK"===(o=a.sent()).code&&i(o.session),[2,o.code]}}))}))},t.loginUserWithFacebook=function(e,t,n,r){return o(this,void 0,void 0,(function(){var o;return a(this,(function(a){switch(a.label){case 0:return[4,c.getSessionWithThirdPartyAuth("facebook",e,t,n,r)];case 1:return"OK"===(o=a.sent()).code&&i(o.session),[2,o.code]}}))}))},t.loginUserWithGoogle=function(e,t,n,r){return o(this,void 0,void 0,(function(){var o;return a(this,(function(a){switch(a.label){case 0:return[4,c.getSessionWithThirdPartyAuth("google",e,t,n,r)];case 1:return"OK"===(o=a.sent()).code&&i(o.session),[2,o.code]}}))}))},t.loginUserWithJwt=function(e,t,n){return o(this,void 0,void 0,(function(){var r;return a(this,(function(o){switch(o.label){case 0:return[4,c.getSessionWithJwt(e,t,n)];case 1:return"OK"===(r=o.sent()).code&&i(r.session),[2,r.code]}}))}))},t.registerUser=function(e,t,n){return o(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,c.registerUser(e,t,n)];case 1:return r.sent(),[2,"OK"]}}))}))},t.getUserInfo=function(){return o(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,r()];case 1:if(!e.sent())throw new Error("User session is not set");return[2,c.getUserInfo()]}}))}))}}),(function(e,t,n){"use strict";function r(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,u.getPlacesDetailed(e,t)]}))}))}function i(e,t){if(o(e))return e;for(var n=e.parents.slice().reverse(),r=0,i=n;r<i.length;r++){var a=i[r],s=t.get(a);if(s&&o(s))return s}var u=n.map((function(e){return t.get(e)})).find((function(e){return"country"===e.level}));return u||t.get(n[0])}function o(e){return t.DESTINATION_BREAK_LEVELS.includes(e.level)}var a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var u=n(65);t.Dao=u;var c=n(72);t.PlacesListFilter=c.PlacesListFilter;var l=n(75);t.hasTag=l.hasTag,t.isStickyByDefault=l.isStickyByDefault;var f=n(76);t.PlacesStatsFilter=f.PlacesStatsFilter,t.DESTINATION_BREAK_LEVELS=["city","town","village","island"],t.getPlaces=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,u.getPlaces(e)]}))}))},t.getPlacesStats=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,u.getPlacesStats(e)]}))}))},t.getPlaceDetailed=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,u.getPlaceDetailed(e,t)]}))}))},t.getPlacesDetailed=r,t.getPlacesDetailedMap=function(e,t){return a(this,void 0,void 0,(function(){var n,i;return s(this,(function(o){switch(o.label){case 0:return[4,r(e,t)];case 1:return n=o.sent(),i=new Map,n.forEach((function(e){i.set(e.id,e)})),[2,i]}}))}))},t.getPlaceMedia=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,u.getPlaceMedia(e)]}))}))},t.createCustomPlace=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,u.createCustomPlace(e)]}))}))},t.updateCustomPlace=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,u.updateCustomPlace(e,t)]}))}))},t.deleteCustomPlace=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,u.deleteCustomPlace(e)]}))}))},t.getPlaceGeometry=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,u.getPlaceGeometry(e)]}))}))},t.getPlaceOpeningHours=function(e,t,n){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,u.getPlaceOpeningHours(e,t,n)]}))}))},t.addPlaceReview=function(e,t,n){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,u.addPlaceReview(e,t,n)]}))}))},t.deletePlaceReview=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,u.deletePlaceReview(e)]}))}))},t.getPlaceReviews=function(e,t,n){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,u.getPlaceReviews(e,t,n)]}))}))},t.voteOnReview=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,u.voteOnReview(e,t)]}))}))},t.detectParentsByBounds=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,u.detectParentsByBounds(e,t)]}))}))},t.detectParentsByLocation=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,u.detectParentsByLocation(e)]}))}))},t.getPlacesMapFromTrip=function(e,t){return a(this,void 0,void 0,(function(){var n,r,i;return s(this,(function(o){switch(o.label){case 0:if(n=new Map,!e.days)throw new Error("Can't generate PDF data for trip without days");return[4,Promise.all(e.days.map((function(e){return u.getPlacesFromTripDay(e,t)})))];case 1:return r=o.sent(),(i=[]).concat.apply(i,r).forEach((function(e){n.set(e.id,e)})),[2,n]}}))}))},t.getPlacesDestinationMap=function(e,t){return a(this,void 0,void 0,(function(){var n,r,o,a,c;return s(this,(function(s){switch(s.label){case 0:return[4,u.getPlacesDetailed(e,t)];case 1:return n=s.sent(),r=new Set,n.forEach((function(e){e.parents.forEach((function(e){return r.add(e)}))})),[4,u.getPlacesDetailed(Array.from(r),t)];case 2:return o=s.sent(),a=new Map,o.forEach((function(e){a.set(e.id,e)})),c=new Map,n.forEach((function(e){var t=i(e,a);c.set(e.id,t)})),[2,c]}}))}))},t.getPlaceDestination=i,t.isPlaceDestination=o,t.mergePlacesArrays=function(e,t){return t.reduce((function(e,t){return void 0===e.find((function(e){return e.id===t.id}))&&e.push(t),e}),e)}}),(function(e,t,n){"use strict";function r(e){var t=("0"+e.getDate()).slice(-2),n=("0"+(e.getMonth()+1)).slice(-2);return[e.getFullYear().toString(),n,t].join("-")}Object.defineProperty(t,"__esModule",{value:!0}),t.addDaysToDate=function(e,t){var n=new Date(e);return n.setDate(n.getDate()+t),r(n)},t.sleep=function(e){return new Promise(function(t){return setTimeout(t,e)})},t.subtractDaysFromDate=function(e,t){var n=new Date(e);return n.setDate(n.getDate()-t),r(n)},t.listToEnum=function(e){return e.reduce((function(e,t){return e[t]=t,e}),Object.create(null))},t.dateToW3CString=function(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString();e.getMonth()+1<10&&(n="0"+n);var r=e.getDate().toString();e.getDate()<10&&(r="0"+r);var i=e.getHours().toString();e.getHours()<10&&(i="0"+i);var o=e.getMinutes().toString();e.getMinutes()<10&&(o="0"+o);var a=e.getSeconds().toString();e.getSeconds()<10&&(a="0"+a);var s=-e.getTimezoneOffset(),u=Math.abs(Math.floor(s/60)),c=u.toString(),l=(Math.abs(s)-60*u).toString();Math.abs(Math.floor(s/60))<10&&(c="0"+c.toString()),Math.abs(s)-60*u<10&&(l="0"+l);var f="+";return s<0&&(f="-"),t+"-"+n+"-"+r+"T"+i+":"+o+":"+a+f+c+":"+l},t.toRadians=function(e){return e*Math.PI/180},t.toDegrees=function(e){return 180*e/Math.PI}}),(function(e,t,n){"use strict";function r(e,t){return t.encode?t.strict?o(e):encodeURIComponent(e):e}function i(e){return Array.isArray(e)?e.sort():"object"==typeof e?i(Object.keys(e)).sort((function(e,t){return Number(e)-Number(t)})).map((function(t){return e[t]})):e}var o=n(66),a=n(67),s=n(68);t.extract=function(e){var t=e.indexOf("?");return-1===t?"":e.slice(t+1)},t.parse=function(e,t){var n=(function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return function(e,n,r){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}})(t=a({arrayFormat:"none"},t)),r=Object.create(null);return"string"!=typeof e?r:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),i=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:s(o),n(s(i),o,r)})),Object.keys(r).sort().reduce((function(e,t){var n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=i(n):e[t]=n,e}),Object.create(null))):r},t.stringify=function(e,t){var n=(function(e){switch(e.arrayFormat){case"index":return function(t,n,i){return null===n?[r(t,e),"[",i,"]"].join(""):[r(t,e),"[",r(i,e),"]=",r(n,e)].join("")};case"bracket":return function(t,n){return null===n?r(t,e):[r(t,e),"[]=",r(n,e)].join("")};default:return function(t,n){return null===n?r(t,e):[r(t,e),"=",r(n,e)].join("")}}})(t=a({encode:!0,strict:!0,arrayFormat:"none"},t));return e?Object.keys(e).sort().map((function(i){var o=e[i];if(void 0===o)return"";if(null===o)return r(i,t);if(Array.isArray(o)){var a=[];return o.slice().forEach((function(e){void 0!==e&&a.push(n(i,e,a.length))})),a.join("&")}return r(i,t)+"="+r(o,t)})).filter((function(e){return e.length>0})).join("&"):""}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,o,a,s,u="sygictravel";t.setEnvironment=function(e){e.stApiUrl&&(r=e.stApiUrl),e.ssoApiUrl&&(i=e.ssoApiUrl),e.ssoClientId&&(o=e.ssoClientId),e.integratorApiKey&&(a=e.integratorApiKey),e.kiwiPartnerId&&(u=e.kiwiPartnerId)},t.getStApiUrl=function(){return r},t.getSsoApiUrl=function(){return i},t.getSsoClientId=function(){return o},t.getIntegratorKey=function(){return a},t.setTripConflictHandler=function(e){s=e},t.getTripConflictHandler=function(){return s},t.getKiwiParnerId=function(){return u}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),i=n(61);t.placesDetailedCache=new i.InMemoryCache,t.tripsDetailedCache=new i.InMemoryCache,t.routesCache=new i.InMemoryCache,t.userCache=new i.InMemoryCache,t.favoritesCache=new i.InMemoryCache,t.sessionCache="object"==typeof window&&window.document?new r.BrowserCookieCache:new i.InMemoryCache}),(function(e,t,n){"use strict";function r(e){return u(this,void 0,void 0,(function(){var t,n,r,o;return c(this,(function(a){switch(a.label){case 0:return[4,d.getTripDetailed(e)];case 1:return(t=a.sent()).days?(n=i(t),r=v.putPlacesToTrip,o=[t],[4,l.getPlacesDetailed(n,"300x300")]):[3,3];case 2:return[2,r.apply(void 0,o.concat([a.sent()]))];case 3:return[2,t]}}))}))}function i(e){if(!e.days)return[];return e.days.reduce((function(e,t){return e.concat(t.itinerary.map((function(e){return e.placeId})))}),[])}function o(e,t,n,i,o){return u(this,void 0,void 0,(function(){var a,s,u,p,v,g,b,w,m,_,T;return c(this,(function(c){switch(c.label){case 0:return[4,Promise.all([r(e),l.getPlacesDetailed(n,"300x300"),f.getUserSettings()])];case 1:if(a=c.sent(),s=a[0],u=a[1],p=a[2],!s.days||!s.days[t])throw new Error("Trip does not have day on index "+t);return void 0!==o&&null!==o?[3,3]:[4,l.getPlacesDetailed(u[0].parents,"300x300")];case 2:v=c.sent(),g=v.filter((function(e){return l.DESTINATION_BREAK_LEVELS.includes(e.level)})),b=y.getAddToTripInstructions(u[0],s,t,g.map((function(e){return e.id})),p),o=b.position,b.shouldDuplicate&&(s=h.duplicateItineraryItem(s,t,b.position,!0),o++),c.label=3;case 3:for(w=0,m=0,_=u;m<_.length;m++)T=_[m],s=h.addPlaceToDay(s,T,t,p,o+w),i&&i[w]&&(s=h.setTransport(s,t,o+w,i[w])),w++;return[2,d.updateTrip(s)]}}))}))}function a(e){return u(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return t=e,[4,s(e.trip)];case 1:return t.trip=n.sent(),[2,e]}}))}))}function s(e){return u(this,void 0,void 0,(function(){var t,n,r;return c(this,(function(o){switch(o.label){case 0:return t=i(e),n=v.putPlacesToTrip,r=[e],[4,l.getPlacesDetailed(t,"300x300")];case 1:return[2,n.apply(void 0,r.concat([o.sent()]))]}}))}))}var u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var l=n(5),f=n(4),p=n(6),d=n(77);t.Dao=d;var h=n(78),v=n(19),y=n(79),g=n(80);t.isTransportAvoid=g.isTransportAvoid,t.isTransportMode=g.isTransportMode,t.UNBREAKABLE_TRANSPORT_MODES=g.UNBREAKABLE_TRANSPORT_MODES,t.createTrip=function(e,t,n,r){return u(this,void 0,void 0,(function(){return c(this,(function(i){return[2,d.createTrip(v.mapTripCreateRequest(e,t,n,r))]}))}))},t.getTrips=function(e,t){return u(this,void 0,void 0,(function(){return c(this,(function(n){return[2,d.getTrips(e,t)]}))}))},t.getTripsInTrash=function(){return u(this,void 0,void 0,(function(){return c(this,(function(e){return[2,d.getTripsInTrash()]}))}))},t.getTripDetailed=r,t.cloneTrip=function(e){return u(this,void 0,void 0,(function(){return c(this,(function(t){return[2,d.cloneTrip(e)]}))}))},t.getPlacesIdsFromTrip=i,t.updateTrip=function(e,t){return u(this,void 0,void 0,(function(){var n;return c(this,(function(i){switch(i.label){case 0:return[4,r(e)];case 1:return n=i.sent(),t.name&&(n.name=t.name),t.startsOn&&(n.startsOn=t.startsOn,n.endsOn=p.addDaysToDate(t.startsOn,n.days?n.days.length-1:0)),t.privacyLevel&&(n.privacyLevel=t.privacyLevel),void 0!==t.isDeleted&&(n.isDeleted=t.isDeleted),[2,d.updateTrip(n)]}}))}))},t.addDaysToTrip=function(e,t,n){return u(this,void 0,void 0,(function(){var i,o,a,s,u,l,p,v;return c(this,(function(c){switch(c.label){case 0:return[4,r(e)];case 1:i=c.sent(),u=0,c.label=2;case 2:return u<t?(a=(o=h).addDay,s=[i],[4,f.getUserSettings()]):[3,5];case 3:i=a.apply(o,s.concat([c.sent()])),c.label=4;case 4:return u++,[3,2];case 5:u=0,c.label=6;case 6:return u<n?(p=(l=h).prependDayToTrip,v=[i],[4,f.getUserSettings()]):[3,9];case 7:i=p.apply(l,v.concat([c.sent()])),c.label=8;case 8:return u++,[3,6];case 9:return[2,d.updateTrip(i)]}}))}))},t.removeDayFromTrip=function(e,t){return u(this,void 0,void 0,(function(){var n,i,o,a,s;return c(this,(function(u){switch(u.label){case 0:return i=(n=d).updateTrip,a=(o=h).removeDayFromTrip,[4,r(e)];case 1:return s=[u.sent(),t],[4,f.getUserSettings()];case 2:return[2,i.apply(n,[a.apply(o,s.concat([u.sent()]))])]}}))}))},t.swapDaysInTrip=function(e,t,n){return u(this,void 0,void 0,(function(){var i,o,a,s,u;return c(this,(function(c){switch(c.label){case 0:return o=(i=d).updateTrip,s=(a=h).swapDaysInTrip,[4,r(e)];case 1:return u=[c.sent(),t,n],[4,f.getUserSettings()];case 2:return[2,o.apply(i,[s.apply(a,u.concat([c.sent()]))])]}}))}))},t.setTransport=function(e,t,n,i){return u(this,void 0,void 0,(function(){var o,a,s,u;return c(this,(function(c){switch(c.label){case 0:return a=(o=d).updateTrip,u=(s=h).setTransport,[4,r(e)];case 1:return[2,a.apply(o,[u.apply(s,[c.sent(),t,n,i])])]}}))}))},t.updateItineraryItemUserData=function(e,t,n,i,o,a){return u(this,void 0,void 0,(function(){var s,u,l,f;return c(this,(function(c){switch(c.label){case 0:return u=(s=d).updateTrip,f=(l=h).updateItineraryItemUserData,[4,r(e)];case 1:return[2,u.apply(s,[f.apply(l,[c.sent(),t,n,i,o,a])])]}}))}))},t.updateDayNote=function(e,t,n){return u(this,void 0,void 0,(function(){var i,o,a,s;return c(this,(function(u){switch(u.label){case 0:return o=(i=d).updateTrip,s=(a=h).updateDayNote,[4,r(e)];case 1:return[2,o.apply(i,[s.apply(a,[u.sent(),t,n])])]}}))}))},t.movePlaceInDay=function(e,t,n,i){return u(this,void 0,void 0,(function(){var o,a,s,u,l;return c(this,(function(c){switch(c.label){case 0:return a=(o=d).updateTrip,u=(s=h).movePlaceInDay,[4,r(e)];case 1:return l=[c.sent(),t,n,i],[4,f.getUserSettings()];case 2:return[2,a.apply(o,[u.apply(s,l.concat([c.sent()]))])]}}))}))},t.removePlacesFromDay=function(e,t,n){return u(this,void 0,void 0,(function(){var i,o,a,s,u;return c(this,(function(c){switch(c.label){case 0:return o=(i=d).updateTrip,s=(a=h).removePlacesFromDay,[4,r(e)];case 1:return u=[c.sent(),t,n],[4,f.getUserSettings()];case 2:return[2,o.apply(i,[s.apply(a,u.concat([c.sent()]))])]}}))}))},t.removeAllPlacesFromDay=function(e,t){return u(this,void 0,void 0,(function(){var n,i,o,a,s;return c(this,(function(u){switch(u.label){case 0:return i=(n=d).updateTrip,a=(o=h).removeAllPlacesFromDay,[4,r(e)];case 1:return s=[u.sent(),t],[4,f.getUserSettings()];case 2:return[2,i.apply(n,[a.apply(o,s.concat([u.sent()]))])]}}))}))},t.removePlaceFromDaysByPlaceId=function(e,t,n){return u(this,void 0,void 0,(function(){var i,o;return c(this,(function(a){switch(a.label){case 0:return[4,r(e)];case 1:return i=a.sent(),[4,f.getUserSettings()];case 2:return o=a.sent(),n.forEach((function(e){i=h.removePlaceFromDayByPlaceId(i,t,e,o)})),[2,d.updateTrip(i)]}}))}))},t.setOvernightPlace=function(e,t,n){return u(this,void 0,void 0,(function(){var i,o,a;return c(this,(function(s){switch(s.label){case 0:return[4,r(e)];case 1:return i=s.sent(),[4,l.getPlaceDetailed(t,"300x300")];case 2:return o=s.sent(),[4,f.getUserSettings()];case 3:return a=s.sent(),n.forEach((function(e){i=h.addOrReplaceOvernightPlace(i,o,e,a)})),[2,d.updateTrip(i)]}}))}))},t.addPlaceToDay=function(e,t,n,r){return u(this,void 0,void 0,(function(){return c(this,(function(i){return[2,o(e,n,[t],[null],r)]}))}))},t.addSequenceToDay=o,t.handleTripChanges=function(e){return u(this,void 0,void 0,(function(){var t,n,r,i,o,a,s;return c(this,(function(u){switch(u.label){case 0:t=[],n=0,r=e,u.label=1;case 1:return n<r.length?(i=r[n]).id?(o=i.id,(a="updated"===i.change)?[4,d.shouldNotifyOnTripUpdate(o,i.version)]:[3,3]):[3,7]:[3,8];case 2:a=u.sent(),u.label=3;case 3:return a&&t.push(i),(s="deleted"===i.change)?[4,d.isTripInCache(o)]:[3,5];case 4:s=u.sent(),u.label=5;case 5:return s?[4,d.deleteTripFromCache(o)]:[3,7];case 6:u.sent(),t.push(i),u.label=7;case 7:return n++,[3,1];case 8:return[2,t]}}))}))},t.emptyTripsTrash=function(){return u(this,void 0,void 0,(function(){return c(this,(function(e){return[2,d.emptyTripsTrash()]}))}))},t.getTripTemplates=function(e){return u(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return[4,d.getTripTemplates(e)];case 1:return t=n.sent(),[2,Promise.all(t.map(a))]}}))}))},t.applyTripTemplate=function(e,t,n){return u(this,void 0,void 0,(function(){var r;return c(this,(function(i){switch(i.label){case 0:return[4,d.applyTripTemplate(e,t,n)];case 1:return r=i.sent(),[2,s(r)]}}))}))},t.ensureTripSyncedToServer=function(e){return u(this,void 0,void 0,(function(){return c(this,(function(t){return[2,d.syncChangedTripToServer(e)]}))}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t,n){this._statusCode=e,this._data=t,this._serverTimestamp=n||null}return Object.defineProperty(e.prototype,"statusCode",{get:function(){return this._statusCode},set:function(e){this._statusCode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverTimestamp",{get:function(){return this._serverTimestamp},set:function(e){this._serverTimestamp=e},enumerable:!0,configurable:!0}),e})();t.ApiResponse=r}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),a=n(10),s=n(112),u=n(114);t.Mapper=u;var c=n(115);t.ModeSelector=c,t.getRoutesForTripDay=function(e,t){return r(this,void 0,void 0,(function(){var n,r,u,c;return i(this,(function(i){switch(i.label){case 0:return[4,a.Dao.getTripDetailed(e)];case 1:if(null===(n=i.sent()))throw new Error("Trip not found.");if(!n.days||!n.days[t])throw new Error("Trip does not have day on index "+t);return r=n.days[t],[4,o.Dao.getPlacesFromTripDay(r,"100x100")];case 2:return u=i.sent(),[4,s.getRoutes(l(u,r))];case 3:return c=i.sent(),[2,{routes:f(c),userTransportSettings:r.itinerary.slice(1).map((function(e){return e.transportFromPrevious}))}]}}))}))};var l=function(e,t){return t.itinerary.reduce((function(n,r,i){if(!i)return n;var o=t.itinerary[i-1],a=e.find((function(e){return e.id===o.placeId})),s=e.find((function(e){return e.id===r.placeId}));if(!s||!a)throw new Error("Place not found!");return r.transportFromPrevious?n.push(u.createRouteRequest(s.location,a.location,r.transportFromPrevious.routeId,r.transportFromPrevious.waypoints,r.transportFromPrevious.avoid,r.transportFromPrevious.mode)):n.push(u.createRouteRequest(s.location,a.location)),n}),[])};t.getDirections=function(e,t,n,o){return r(this,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return[4,s.getRoutes([u.createRouteRequest(t,e,null,n,o)])];case 1:return r=i.sent(),r=f(r),[2,r.length>0?r[0]:null]}}))}))};var f=function(e){return e.map((function(e){var t=c.getAvailableModes(e.origin,e.destination);return e.modeDirections=e.modeDirections.filter((function(e){return-1!==t.indexOf(e.mode)})),e}))}}),(function(e,t,n){e.exports=n(39)}),(function(e,t,n){"use strict";(function(t){function r(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var i=n(2),o=n(42),a={"Content-Type":"application/x-www-form-urlencoded"},s={adapter:(function(){var e;return"undefined"!=typeof XMLHttpRequest?e=n(23):void 0!==t&&(e=n(23)),e})(),transformRequest:[function(e,t){return o(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(r(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)?(r(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};s.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],(function(e){s.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){s.headers[e]=i.merge(a)})),e.exports=s}).call(t,n(22))}),(function(e,t,n){(function(e,n){function r(e,t){return e.set(t[0],t[1]),e}function i(e,t){return e.add(t),e}function o(e,t,n,r){var i=-1,o=e?e.length:0;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function a(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function s(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function u(e,t){return function(n){return e(t(n))}}function c(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function l(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function f(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function p(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function d(e){this.__data__=new f(e)}function h(e,t){var n=Qe(e)||(function(e){return (function(e){return (function(e){return!!e&&"object"==typeof e})(e)&&x(e)})(e)&&me.call(e,"callee")&&(!Ae.call(e,"callee")||_e.call(e)==R)})(e)?(function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r})(e.length,String):[],r=n.length,i=!!r;for(var o in e)!t&&!me.call(e,o)||i&&("length"==o||(function(e,t){return!!(t=null==t?j:t)&&("number"==typeof e||ae.test(e))&&e>-1&&e%1==0&&e<t})(o,r))||n.push(o);return n}function v(e,t,n){var r=e[t];me.call(e,t)&&O(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function y(e,t){for(var n=e.length;n--;)if(O(e[n][0],t))return n;return-1}function g(e,t,n,u,l,f,p){var h;if(u&&(h=f?u(e,l,f,p):u(e)),void 0!==h)return h;if(!A(e))return e;var y=Qe(e);if(y){if(h=(function(e){var t=e.length,n=e.constructor(t);t&&"string"==typeof e[0]&&me.call(e,"index")&&(n.index=e.index,n.input=e.input);return n})(e),!t)return (function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t})(e,h)}else{var b=Ve(e),_=b==F||b==U;if($e(e))return (function(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n})(e,t);if(b==W||b==R||_&&!f){if(a(e))return f?e:{};if(h=(function(e){return"function"!=typeof e.constructor||P(e)?{}:(function(e){return A(e)?De(e):{}})(xe(e))})(_?{}:e),!t)return (function(e,t){return m(e,He(e),t)})(e,(function(e,t){return e&&m(t,C(t),e)})(h,e))}else{if(!se[b])return f?e:{};h=(function(e,t,n,a){var u=e.constructor;switch(t){case V:return w(e);case M:case E:return new u(+e);case Q:return (function(e,t){var n=t?w(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)})(e,a);case $:case J:case Z:case X:case Y:case ee:case te:case ne:case re:return (function(e,t){var n=t?w(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)})(e,a);case L:return (function(e,t,n){return o(t?n(s(e),!0):s(e),r,new e.constructor)})(e,a,n);case B:case q:return new u(e);case N:return (function(e){var t=new e.constructor(e.source,ie.exec(e));return t.lastIndex=e.lastIndex,t})(e);case K:return (function(e,t,n){return o(t?n(c(e),!0):c(e),i,new e.constructor)})(e,a,n);case G:return (function(e){return Ge?Object(Ge.call(e)):{}})(e)}})(e,b,g,t)}}p||(p=new d);var T=p.get(e);if(T)return T;if(p.set(e,h),!y)var S=n?(function(e){return (function(e,t,n){var r=t(e);return Qe(e)?r:(function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e})(r,n(e))})(e,C,He)})(e):C(e);return (function(e,t){for(var n=-1,r=e?e.length:0;++n<r&&!1!==t(e[n],n,e););})(S||e,(function(r,i){S&&(r=e[i=r]),v(h,i,g(r,t,n,u,i,e,p))})),h}function b(e){if(!A(e)||(function(e){return!!be&&be in e})(e))return!1;return(D(e)||a(e)?Te:oe).test(S(e))}function w(e){var t=new e.constructor(e.byteLength);return new Oe(t).set(new Oe(e)),t}function m(e,t,n,r){n||(n={});for(var i=-1,o=t.length;++i<o;){var a=t[i],s=r?r(n[a],e[a],a,n,e):void 0;v(n,a,void 0===s?e[a]:s)}return n}function _(e,t){var n=e.__data__;return (function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e})(t)?n["string"==typeof t?"string":"hash"]:n.map}function T(e,t){var n=(function(e,t){return null==e?void 0:e[t]})(e,t);return b(n)?n:void 0}function P(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ye)}function S(e){if(null!=e){try{return we.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function O(e,t){return e===t||e!=e&&t!=t}function x(e){return null!=e&&(function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=j})(e.length)&&!D(e)}function D(e){var t=A(e)?_e.call(e):"";return t==F||t==U}function A(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function C(e){return x(e)?h(e):(function(e){if(!P(e))return je(e);var t=[];for(var n in Object(e))me.call(e,n)&&"constructor"!=n&&t.push(n);return t})(e)}var I=200,k="__lodash_hash_undefined__",j=9007199254740991,R="[object Arguments]",M="[object Boolean]",E="[object Date]",F="[object Function]",U="[object GeneratorFunction]",L="[object Map]",B="[object Number]",W="[object Object]",z="[object Promise]",N="[object RegExp]",K="[object Set]",q="[object String]",G="[object Symbol]",H="[object WeakMap]",V="[object ArrayBuffer]",Q="[object DataView]",$="[object Float32Array]",J="[object Float64Array]",Z="[object Int8Array]",X="[object Int16Array]",Y="[object Int32Array]",ee="[object Uint8Array]",te="[object Uint8ClampedArray]",ne="[object Uint16Array]",re="[object Uint32Array]",ie=/\w*$/,oe=/^\[object .+?Constructor\]$/,ae=/^(?:0|[1-9]\d*)$/,se={};se[R]=se["[object Array]"]=se[V]=se[Q]=se[M]=se[E]=se[$]=se[J]=se[Z]=se[X]=se[Y]=se[L]=se[B]=se[W]=se[N]=se[K]=se[q]=se[G]=se[ee]=se[te]=se[ne]=se[re]=!0,se["[object Error]"]=se[F]=se[H]=!1;var ue="object"==typeof e&&e&&e.Object===Object&&e,ce="object"==typeof self&&self&&self.Object===Object&&self,le=ue||ce||Function("return this")(),fe="object"==typeof t&&t&&!t.nodeType&&t,pe=fe&&"object"==typeof n&&n&&!n.nodeType&&n,de=pe&&pe.exports===fe,he=Array.prototype,ve=Function.prototype,ye=Object.prototype,ge=le["__core-js_shared__"],be=(function(){var e=/[^.]+$/.exec(ge&&ge.keys&&ge.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""})(),we=ve.toString,me=ye.hasOwnProperty,_e=ye.toString,Te=RegExp("^"+we.call(me).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Pe=de?le.Buffer:void 0,Se=le.Symbol,Oe=le.Uint8Array,xe=u(Object.getPrototypeOf,Object),De=Object.create,Ae=ye.propertyIsEnumerable,Ce=he.splice,Ie=Object.getOwnPropertySymbols,ke=Pe?Pe.isBuffer:void 0,je=u(Object.keys,Object),Re=T(le,"DataView"),Me=T(le,"Map"),Ee=T(le,"Promise"),Fe=T(le,"Set"),Ue=T(le,"WeakMap"),Le=T(Object,"create"),Be=S(Re),We=S(Me),ze=S(Ee),Ne=S(Fe),Ke=S(Ue),qe=Se?Se.prototype:void 0,Ge=qe?qe.valueOf:void 0;l.prototype.clear=function(){this.__data__=Le?Le(null):{}},l.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},l.prototype.get=function(e){var t=this.__data__;if(Le){var n=t[e];return n===k?void 0:n}return me.call(t,e)?t[e]:void 0},l.prototype.has=function(e){var t=this.__data__;return Le?void 0!==t[e]:me.call(t,e)},l.prototype.set=function(e,t){return this.__data__[e]=Le&&void 0===t?k:t,this},f.prototype.clear=function(){this.__data__=[]},f.prototype.delete=function(e){var t=this.__data__,n=y(t,e);return!(n<0||(n==t.length-1?t.pop():Ce.call(t,n,1),0))},f.prototype.get=function(e){var t=this.__data__,n=y(t,e);return n<0?void 0:t[n][1]},f.prototype.has=function(e){return y(this.__data__,e)>-1},f.prototype.set=function(e,t){var n=this.__data__,r=y(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},p.prototype.clear=function(){this.__data__={hash:new l,map:new(Me||f),string:new l}},p.prototype.delete=function(e){return _(this,e).delete(e)},p.prototype.get=function(e){return _(this,e).get(e)},p.prototype.has=function(e){return _(this,e).has(e)},p.prototype.set=function(e,t){return _(this,e).set(e,t),this},d.prototype.clear=function(){this.__data__=new f},d.prototype.delete=function(e){return this.__data__.delete(e)},d.prototype.get=function(e){return this.__data__.get(e)},d.prototype.has=function(e){return this.__data__.has(e)},d.prototype.set=function(e,t){var n=this.__data__;if(n instanceof f){var r=n.__data__;if(!Me||r.length<I-1)return r.push([e,t]),this;n=this.__data__=new p(r)}return n.set(e,t),this};var He=Ie?u(Ie,Object):function(){return[]},Ve=function(e){return _e.call(e)};(Re&&Ve(new Re(new ArrayBuffer(1)))!=Q||Me&&Ve(new Me)!=L||Ee&&Ve(Ee.resolve())!=z||Fe&&Ve(new Fe)!=K||Ue&&Ve(new Ue)!=H)&&(Ve=function(e){var t=_e.call(e),n=t==W?e.constructor:void 0,r=n?S(n):void 0;if(r)switch(r){case Be:return Q;case We:return L;case ze:return z;case Ne:return K;case Ke:return H}return t});var Qe=Array.isArray,$e=ke||function(){return!1};n.exports=function(e){return g(e,!0,!0)}}).call(t,n(62),n(63)(e))}),(function(e,t,n){"use strict";function r(e){return i(this,void 0,void 0,(function(){var t,n,r,i,a,f;return o(this,(function(o){switch(o.label){case 0:return t=[],(n=e.find((function(e){return"settings"===e.type})))&&(t.push(n),l.handleSettingsChange()),i=(r=t).concat,[4,c.handleTripChanges(e.filter((function(e){return"trip"===e.type})))];case 1:return t=i.apply(r,[o.sent()]),f=(a=t).concat,[4,u.handleFavoritesChanges(e.filter((function(e){return"favorite"===e.type})))];case 2:return t=f.apply(a,[o.sent()]),s&&t.length>0&&s(t),[2]}}))}))}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var a,s,u=n(17),c=n(10),l=n(4),f=n(81),p=6e4,d=5e3;t.initializeChangesWatching=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:if(e||(e=p),e<d)throw new Error("Sync changes from server interval must be greater then "+d+"ms.");return a||(a=new f.default(e,r)),[4,a.start()];case 1:return t.sent(),[2]}}))}))},t.stopChangesWatching=function(){a&&(a.kill(),a=null)},t.setChangesCallback=function(e){s=e},t.reset=function(){a&&a.reset()}}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(64);t.getFavoritesIds=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){return[2,o.getFavorites()]}))}))},t.addPlaceToFavorites=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,o.addPlaceToFavorites(e)];case 1:return t.sent(),[2]}}))}))},t.addCustomPlaceToFavorites=function(e,t,n){return r(this,void 0,void 0,(function(){return i(this,(function(r){return[2,o.addCustomPlaceToFavorites(e,t,n)]}))}))},t.removePlaceFromFavorites=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,o.removePlaceFromFavorites(e)];case 1:return t.sent(),[2]}}))}))},t.handleFavoritesChanges=function(e){return r(this,void 0,void 0,(function(){var t,n,r,a,s,u,c;return i(this,(function(i){switch(i.label){case 0:t=[],n=0,r=e,i.label=1;case 1:return n<r.length?(a=r[n]).id?(s=a.id,(u="updated"===a.change)?[4,o.shouldNotifyOnFavoritesUpdate(s)]:[3,3]):[3,6]:[3,7];case 2:u=i.sent(),i.label=3;case 3:return u&&t.push(a),(c="deleted"===a.change)?[4,o.isFavoriteInCache(s)]:[3,5];case 4:c=i.sent(),i.label=5;case 5:c&&(o.removeFavoriteFromCache(s),t.push(a)),i.label=6;case 6:return n++,[3,1];case 7:return[2,t]}}))}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.mapPlaceApiResponseToPlaces=function(e){return e.map((function(e){return t.mapPlace(e,null)}))},t.mapPlaceDetailedApiResponseToPlace=function(e,n){var r=i(e,n);return t.mapPlace(e,r)},t.mapPlaceDetailedBatchApiResponseToPlaces=function(e,n){return e.map((function(e){var r=i(e,n);return t.mapPlace(e,r)}))},t.mapPlace=function(e,t){return{id:e.id,level:e.level,rating:e.rating,location:e.location,quadkey:e.quadkey,name:e.name,nameSuffix:e.name_suffix,originalName:e.original_name,boundingBox:e.bounding_box,perex:e.perex,url:e.url,thumbnailUrl:e.thumbnail_url,marker:e.marker,categories:e.categories,parents:e.parent_ids,starRating:e.star_rating,starRatingUnofficial:e.star_rating_unofficial,customerRating:e.customer_rating,detail:t}};var i=function(e,n){var i=e.tags.map((function(e){return r.camelizeKeys(e)})),o=e.description?r.camelizeKeys(e.description):null,a=e.references.map((function(e){return r.camelizeKeys(e)})),s={tags:i,address:e.address,admission:e.admission,description:o,email:e.email,duration:e.duration,openingHours:e.opening_hours,phone:e.phone,media:t.mapMainMediaToMedia(r.camelizeKeys(e.main_media),n),references:a};return e.owner_id&&(s.ownerId=e.owner_id),s};t.mapMainMediaToMedia=function(e,t){var n={square:null,videoPreview:null,portrait:null,landscape:null};return e&&Object.keys(e.usage).forEach((function(r){var i=e.usage[r];n[r]=e.media.reduce((function(e,n){return n.id===i?(n.urlWithSize=n.urlTemplate.replace(/{size}/i,t||"300x300"),n):e}),null)})),n},t.mapPlaceGeometryApiResponseToPlaceGeometry=function(e){return{geometry:e.geometry,isShape:e.is_shape}},t.mapPlaceOpeningHours=function(e){return e},t.mapPlaceReview=function(e){return r.camelizeKeys(e)},t.mapPlaceReviewsData=function(e){return{rating:e.rating,currentUserHasReview:e.current_user_has_review,reviews:e.reviews.map((function(e){return t.mapPlaceReview(e)}))}}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(15),o=n(30);t.mapTripListApiResponseToTripsList=function(e){return e.map((function(e){return t.mapTrip(e,null,null)}))},t.mapTripDetailedApiResponseToTrip=function(e,n){return t.mapTrip(e,a(e),n)},t.mapTripCreateRequestToApiFormat=function(e){return{name:e.name,starts_on:e.startsOn,days:e.days.map(s),base_version:null,updated_at:null,privacy_level:e.privacyLevel,ends_on:e.startsOn,is_deleted:e.isDeleted}},t.mapTripCreateRequest=function(e,t,n,r){if(n<1||n>81)throw new Error("Invalid trip days count. Value between 1 and 81 expected.");var i=Array(n).fill(null).map((function(){return{note:null,date:null,itinerary:[]}}));return r&&(i[0].itinerary=[{placeId:r,place:null,note:null,duration:null,startTime:null,transportFromPrevious:null,isSticky:!1,isStickyFirstInDay:!1,isStickyLastInDay:!1}]),{name:t,startsOn:e,days:i,privacyLevel:"private",endsOn:e,isDeleted:!1}},t.mapTrip=function(e,n,i){var a={id:e.id,ownerId:e.owner_id,privacyLevel:e.privacy_level,name:e.name,version:e.version,startsOn:e.starts_on,endsOn:e.ends_on,updatedAt:e.updated_at,isDeleted:e.is_deleted,url:e.url,media:r.camelizeKeys(e.media),privileges:r.camelizeKeys(e.privileges),days:o.decorateDaysWithDate(e.starts_on,n)};return t.resolveStickiness(a,i)};var a=function(e){return e.days.map((function(e){return{note:e.note,date:null,itinerary:e.itinerary.map((function(e){return{placeId:e.place_id,startTime:e.start_time,duration:e.duration,note:e.note,isSticky:null,isStickyFirstInDay:null,isStickyLastInDay:null,transportFromPrevious:e.transport_from_previous?{mode:e.transport_from_previous.mode,type:e.transport_from_previous.type,avoid:e.transport_from_previous.avoid,startTime:e.transport_from_previous.start_time,duration:e.transport_from_previous.duration,note:e.transport_from_previous.note,waypoints:e.transport_from_previous.waypoints.map((function(e){return{placeId:e.place_id,location:e.location}}))}:null}}))}}))};t.resolveStickiness=function(e,t){var n=i(e);if(null===n.days)return n;var r,o;return n.days.forEach((function(e,i){e.itinerary.forEach((function(e){e.isSticky=!1,e.isStickyFirstInDay=!1,e.isStickyLastInDay=!1})),t&&0===i&&e.itinerary.length>0&&(t.homePlaceId&&e.itinerary[0].placeId===t.homePlaceId||t.workPlaceId&&e.itinerary[0].placeId===t.workPlaceId)&&(e.itinerary[0].isSticky=!0,e.itinerary[0].isStickyFirstInDay=!0),r&&r.itinerary.length&&e.itinerary.length&&e.itinerary[0].placeId===r.itinerary[r.itinerary.length-1].placeId&&(e.itinerary[0].isSticky=!0,e.itinerary[0].isStickyFirstInDay=!0),(o=n.days&&n.days[i+1]?n.days[i+1]:null)&&o.itinerary.length&&e.itinerary.length&&e.itinerary[e.itinerary.length-1].placeId===o.itinerary[0].placeId&&(e.itinerary[e.itinerary.length-1].isSticky=!0,e.itinerary[e.itinerary.length-1].isStickyLastInDay=!0),t&&null===o&&e.itinerary.length>0&&(t.homePlaceId&&e.itinerary[e.itinerary.length-1].placeId===t.homePlaceId||t.workPlaceId&&e.itinerary[e.itinerary.length-1].placeId===t.workPlaceId)&&(e.itinerary[e.itinerary.length-1].isSticky=!0,e.itinerary[e.itinerary.length-1].isStickyLastInDay=!0),r=e})),n},t.putPlacesToTrip=function(e,t){return e.days&&e.days.forEach((function(e){return e.itinerary.forEach((function(e){var n=t.filter((function(t){return t.id===e.placeId}));n.length>0&&(e.place=n[0])}))})),e},t.mapTripToApiFormat=function(e){return{id:e.id,owner_id:e.ownerId,privacy_level:e.privacyLevel,name:e.name,version:e.version,starts_on:e.startsOn,ends_on:e.endsOn,updated_at:e.updatedAt,is_deleted:e.isDeleted,url:e.url,media:r.decamelizeKeys(e.media),privileges:r.decamelizeKeys(e.privileges),days:e.days&&e.days.map(s)}},t.mapTripToApiUpdateFormat=function(e){var n=t.mapTripToApiFormat(e);return n.hasOwnProperty("version")&&(n.base_version=n.version,delete n.version),n};var s=function(e){return{note:e.note,itinerary:e.itinerary.map((function(e){return{place_id:e.placeId,start_time:e.startTime,duration:e.duration,note:e.note,transport_from_previous:e.transportFromPrevious?{mode:e.transportFromPrevious.mode,avoid:e.transportFromPrevious.avoid,start_time:e.transportFromPrevious.startTime,duration:e.transportFromPrevious.duration,note:e.transportFromPrevious.note,waypoints:e.transportFromPrevious.waypoints.map((function(e){return{place_id:e.placeId,location:e.location}}))}:null}}))}};t.mapTripTemplateApiResponse=function(e,n){return{id:e.id,description:e.description,duration:e.duration,trip:t.mapTripDetailedApiResponseToTrip(e.trip,n)}}}),(function(e,t,n){"use strict";function r(e){if(u){var t={type:c.EventType.USER_DATA_CHANGES,payload:e};u(t)}}function i(e,t){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){return u?(n={type:c.EventType.TRIP_CONFLICT,payload:{conflictInfo:e,trip:t}},(r=u(n))?[2,r]:[2,"server"]):[2,"server"]}))}))}function o(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return e={type:c.EventType.INVALID_SESSION,payload:null},[4,d.setUserSession(null)];case 1:return t.sent(),u&&u(e),[2]}}))}))}var a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var u,c=n(37),l=n(0),f=n(16),p=n(8),d=n(4);t.setEventsHandler=function(e){u=e},t.initalize=function(){console.log("ST: Init handler"),f.setChangesCallback(r),p.setTripConflictHandler(i),l.StApi.setInvalidSessionHandler(o)}}),(function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}}),(function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(){h&&p&&(h=!1,p.length?d=p.concat(d):v=-1,d.length&&a())}function a(){if(!h){var e=i(o);h=!0;for(var t=d.length;t;){for(p=d,d=[];++v<t;)p&&p[v].run();v=-1,t=d.length}p=null,h=!1,(function(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}})(e)}}function s(e,t){this.fun=e,this.array=t}function u(){}var c,l,f=e.exports={};!(function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}})();var p,d=[],h=!1,v=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new s(e,t)),1!==d.length||h||i(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.prependListener=u,f.prependOnceListener=u,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}}),(function(e,t,n){"use strict";(function(t){var r=n(2),i=n(43),o=n(45),a=n(46),s=n(47),u=n(24),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(48);e.exports=function(e){return new Promise(function(l,f){var p=e.data,d=e.headers;r.isFormData(p)&&delete d["Content-Type"];var h=new XMLHttpRequest,v="onreadystatechange",y=!1;if("test"===t.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in h||s(e.url)||(h=new window.XDomainRequest,v="onload",y=!0,h.onprogress=function(){},h.ontimeout=function(){}),e.auth){var g=e.auth.username||"",b=e.auth.password||"";d.Authorization="Basic "+c(g+":"+b)}if(h.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h[v]=function(){if(h&&(4===h.readyState||y)&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var t="getAllResponseHeaders"in h?a(h.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:1223===h.status?204:h.status,statusText:1223===h.status?"No Content":h.statusText,headers:t,config:e,request:h};i(l,f,n),h=null}},h.onerror=function(){f(u("Network Error",e,null,h)),h=null},h.ontimeout=function(){f(u("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",h)),h=null},r.isStandardBrowserEnv()){var w=n(49),m=(e.withCredentials||s(e.url))&&e.xsrfCookieName?w.read(e.xsrfCookieName):void 0;m&&(d[e.xsrfHeaderName]=m)}if("setRequestHeader"in h&&r.forEach(d,(function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete d[t]:h.setRequestHeader(t,e)})),e.withCredentials&&(h.withCredentials=!0),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){h&&(h.abort(),f(e),h=null)})),void 0===p&&(p=null),h.send(p)})}}).call(t,n(22))}),(function(e,t,n){"use strict";var r=n(44);e.exports=function(e,t,n,i,o){var a=new Error(e);return r(a,t,n,i,o)}}),(function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}}),(function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(6);t.locationToTileCoordinate=function(e,t){var n=(e.lng+180)/360,r=Math.sin(e.lat*Math.PI/180),i=.5-Math.log((1+r)/(1-r))/(4*Math.PI),a=256<<t,s=o(n*a+.5,0,a-1)/256,u=o(i*a+.5,0,a-1)/256;return{x:Math.floor(s),y:Math.floor(u)}},t.locationToCanvasCoordinate=function(e,t,n){var r=t.north-e.lat,i=e.lng-t.west,o=n.height/Math.abs(t.south-t.north),a=n.width/Math.abs(t.west-t.east);return t.west>t.east&&(a=n.width/Math.abs(180-t.west+180+t.east),e.lng<0&&e.lng<t.east&&(i=180-t.west+180+e.lng),e.lng>0&&e.lng<t.west&&(i=180-t.west+180+e.lng)),{x:Math.round(i*a),y:Math.round(r*o)}},t.normalizeLng=function(e){var t=Math.abs(e);return t>360&&(t-=360*Math.floor(t/360)),t>180&&(t-=360),e<0?-1*t:t};var o=function(e,t,n){return Math.max(t,Math.min(e,n))};t.locationWithOffset=function(e,t,n){n=i.toRadians(n);var o=i.toRadians(e.lat),a=i.toRadians(e.lng),s=t/r.EARTH_RADIUS,u=Math.asin(Math.sin(o)*Math.cos(s)+Math.cos(o)*Math.sin(s)*Math.cos(n)),c=a+Math.atan2(Math.sin(n)*Math.sin(s)*Math.cos(o),Math.cos(s)-Math.sin(o)*Math.sin(u));return{lat:i.toDegrees(u),lng:i.toDegrees(c)}}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(29);!(function(e){e[e.AND=0]="AND",e[e.OR=1]="OR"})(r=t.LogicalOperator||(t.LogicalOperator={}));var o=(function(){function e(e){this._query=e.query,this._mapTiles=e.mapTiles,this._categories=e.categories,this._categoriesOperator=e.categoriesOperator?e.categoriesOperator:r.AND,this._tags=e.tags,this._tagsOperator=e.tagsOperator?e.tagsOperator:r.AND,this._parents=e.parents,this._parentsOperator=e.parentsOperator?e.parentsOperator:r.AND,this._levels=e.levels,this._bounds=e.bounds,this._zoom=e.zoom,this.validate()}return Object.defineProperty(e.prototype,"bounds",{get:function(){return this._bounds||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom||null},enumerable:!0,configurable:!0}),e.prototype.toQueryObject=function(){var e={};return this._query&&(e.query=this._query),this._mapTiles&&(e.map_tiles=this._mapTiles.join("|")),this._categories&&this._categories.length>0&&(e.categories=this._categories.join(this._categoriesOperator===r.AND?",":"|")),this._tags&&this._tags.length>0&&(e.tags=this._tags.join(this._tagsOperator===r.AND?",":"|")),this._parents&&this._parents.length>0&&(e.parents=this._parents.join(this._parentsOperator===r.AND?",":"|")),this._levels&&(e.levels=this._levels.join("|")),this._bounds&&(e.bounds=this._bounds.south+","+this._bounds.west+","+this._bounds.north+","+this._bounds.east),e},e.prototype.toQueryString=function(){return i.stringify(this.toQueryObject())},e.prototype.validate=function(){},e})();t.PlacesFilter=o}),(function(e,t,n){"use strict";t.decode=t.parse=n(73),t.encode=t.stringify=n(74)}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.decorateDaysWithDate=function(e,t){return t?t.map((function(t,n){return t.date=e?r.addDaysToDate(e,n):null,t})):null}}),(function(e,t,n){"use strict";function r(e,t,n){return i(this,void 0,void 0,(function(){return o(this,(function(r){return[2,a.getCollections(e,t,n)]}))}))}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var a=n(91),s=n(93);t.CollectionsFilter=s.CollectionsFilter,t.getCollection=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return[2,a.getCollection(e,t)]}))}))},t.getCollections=r,t.getCollectionsForDestinationId=function(e,t){return i(this,void 0,void 0,(function(){var n;return o(this,(function(i){return n=new s.CollectionsFilter({parentPlaceId:e}),[2,r(n,!0,t)]}))}))}}),(function(e,t,n){"use strict";function r(e){return Math.floor(Math.abs(e)+.5)*Math.sign(e)}function i(e,t,n){var i=(e=r(e*n))-(t=r(t*n));i<<=1,e-t<0&&(i=~i);for(var o="";i>=32;)o+=String.fromCharCode(63+(32|31&i)),i>>=5;return o+=String.fromCharCode(i+63)}function o(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].slice().reverse());return t}var a={};a.decode=function(e,t){for(var n,r=0,i=0,o=0,a=[],s=0,u=0,c=null,l=Math.pow(10,t||5);r<e.length;){c=null,s=0,u=0;do{u|=(31&(c=e.charCodeAt(r++)-63))<<s,s+=5}while(c>=32);n=1&u?~(u>>1):u>>1,s=u=0;do{u|=(31&(c=e.charCodeAt(r++)-63))<<s,s+=5}while(c>=32);i+=n,o+=1&u?~(u>>1):u>>1,a.push([i/l,o/l])}return a},a.encode=function(e,t){if(!e.length)return"";for(var n=Math.pow(10,t||5),r=i(e[0][0],0,n)+i(e[0][1],0,n),o=1;o<e.length;o++){var a=e[o],s=e[o-1];r+=i(a[0],s[0],n),r+=i(a[1],s[1],n)}return r},a.fromGeoJSON=function(e,t){if(e&&"Feature"===e.type&&(e=e.geometry),!e||"LineString"!==e.type)throw new Error("Input must be a GeoJSON LineString");return a.encode(o(e.coordinates),t)},a.toGeoJSON=function(e,t){return{type:"LineString",coordinates:o(a.decode(e,t))}},"object"==typeof e&&e.exports&&(e.exports=a)}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),a=n(0),s=n(1);t.getStaticMap=function(e,t,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return r=s.calculateLocationsBounds(n),[4,a.StApi.post("static-maps",{width:e,height:t,points:n,bounds:r})];case 1:if(!(o=i.sent()).data.hasOwnProperty("url")||!o.data.hasOwnProperty("bounds"))throw new Error("Wrong API response");return[2,{url:o.data.url,bounds:o.data.bounds}]}}))}))},t.generatePdf=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,a.StApi.post("trips/"+e+"/pdf",{})];case 1:if(!(t=n.sent()).data.hasOwnProperty("pdf"))throw new Error("Wrong API response");return[2,o.camelizeKeys(t.data.pdf)]}}))}))},t.getGeneratingState=function(e,t){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,a.StApi.get("trips/"+e+"/pdf?generating_id="+t)];case 1:if(!(n=r.sent()).data.hasOwnProperty("pdf"))throw new Error("Wrong API response");return[2,o.camelizeKeys(n.data.pdf)]}}))}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.getConfig=function(e,t){var n=r.getZoomFromBounds(e,t.width);return[{radius:29,margin:10,name:"popular",photoRequired:!0,minimalRating:.3},{radius:22,margin:5,name:"big",photoRequired:!0,minimalRating:n<10?.001:0},{radius:10,margin:5,name:"medium",photoRequired:!1,minimalRating:n<10?.001:0},{radius:4,margin:5,name:"small",photoRequired:!1,minimalRating:n<10?.001:0}]}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.getSizesConfig=function(){return[{radius:29,margin:0,name:"popular",photoRequired:!0,zoomLevelLimits:[1,1,1,1,.9,.8,.7,.6,.5,.4,.3,.2,.1],disabledCategories:["no_category","eating","going_out","playing","shopping","sleeping","doing_sports","traveling"]},{radius:22,margin:0,name:"big",photoRequired:!0,zoomLevelLimits:[.05,.05,.05,.05,.05,.05,.04,.03,.02,.015,.01,.008,.007,.006,.005,.004,.003],disabledCategories:["no_category","eating","going_out","playing","shopping","sleeping","doing_sports","traveling"]},{radius:10,margin:0,name:"medium",photoRequired:!1,zoomLevelLimits:[.01,.01,.01,.01,.01,.01,.01,.01,.007,.006,.005,.004,.003,.002,.0015,.001,.001,0],disabledCategories:[]},{radius:4,margin:5,name:"small",photoRequired:!1,zoomLevelLimits:[.01,.01,.01,.01,.01,.008,.006,.004,.003,.0025,.002,.0015,.001,5e-4,0],disabledCategories:[]}]},t.getCategoriesConfig=function(){return{noCategory:.3,discovering:.8,eating:.6,goingOut:.6,hiking:.5,playing:.5,relaxing:.6,shopping:.5,sightseeing:1,sleeping:.2,doingSports:.4,traveling:.1}},t.getRatingCoeficientFromCategories=function(e,t){return 0===t.length&&(t=["no_category"]),t.reduce((function(t,n){return e[r.camelize(n)]&&e[r.camelize(n)]>t?e[r.camelize(n)]:t}),0)},t.isDisabledByCategory=function(e,t){if(0===t.length&&(t=["no_category"]),t.length>e.length)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(-1===e.indexOf(i))return!1}return!0}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),i=n(83);t.create=function(e){return r.initalize(),new i.default(e)}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!(function(e){e.USER_DATA_CHANGES="user_data_changes",e.TRIP_CONFLICT="trip_conflict",e.INVALID_SESSION="invalid_session"})(t.EventType||(t.EventType={}))}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(13),a=n(11);t.axiosInstance=o.default.create(),t.get=function(e){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,t.axiosInstance.get(e,{headers:{"Content-Type":"application/json"}})];case 1:return n=r.sent(),[2,(function(e){return new a.ApiResponse(200,e.data)})(n)]}}))}))},t.localeMap={en:"en-US",fr:"fr-FR",nl:"nl-NL",pt:"pt-PT",it:"it-IT",ru:"ru-RU",sk:"sk-SK",pl:"pl-PL",tr:"tr-TR",zh:"zh-CN",cs:"cs-CZ",de:"de-DE",ko:"ko-KR",es:"es-ES"}}),(function(e,t,n){"use strict";function r(e){var t=new a(e),n=o(a.prototype.request,t);return i.extend(n,a.prototype,t),i.extend(n,t),n}var i=n(2),o=n(21),a=n(41),s=n(14),u=r(s);u.Axios=a,u.create=function(e){return r(i.merge(s,e))},u.Cancel=n(26),u.CancelToken=n(55),u.isCancel=n(25),u.all=function(e){return Promise.all(e)},u.spread=n(56),e.exports=u,e.exports.default=u}),(function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(n(e)||(function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))})(e)||!!e._isBuffer)}}),(function(e,t,n){"use strict";function r(e){this.defaults=e,this.interceptors={request:new a,response:new a}}var i=n(14),o=n(2),a=n(50),s=n(51);r.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),(e=o.merge(i,this.defaults,{method:"get"},e)).method=e.method.toLowerCase();var t=[s,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},o.forEach(["delete","get","head","options"],(function(e){r.prototype[e]=function(t,n){return this.request(o.merge(n||{},{method:e,url:t}))}})),o.forEach(["post","put","patch"],(function(e){r.prototype[e]=function(t,n,r){return this.request(o.merge(r||{},{method:e,url:t,data:n}))}})),e.exports=r}),(function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}}),(function(e,t,n){"use strict";var r=n(24);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}}),(function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e}}),(function(e,t,n){"use strict";function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var i=n(2);e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(i.isURLSearchParams(t))o=t.toString();else{var a=[];i.forEach(t,(function(e,t){null!==e&&void 0!==e&&(i.isArray(e)&&(t+="[]"),i.isArray(e)||(e=[e]),i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),a.push(r(t)+"="+r(e))})))})),o=a.join("&")}return o&&(e+=(-1===e.indexOf("?")?"?":"&")+o),e}}),(function(e,t,n){"use strict";var r=n(2),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,a={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}}),(function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?(function(){function e(e){var t=e;return n&&(i.setAttribute("href",t),t=i.href),i.setAttribute("href",t),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");return t=e(window.location.href),function(n){var i=r.isString(n)?e(n):n;return i.protocol===t.protocol&&i.host===t.host}})():function(){return!0}}),(function(e,t,n){"use strict";function r(){this.message="String contains an invalid character"}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";(r.prototype=new Error).code=5,r.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,n,o=String(e),a="",s=0,u=i;o.charAt(0|s)||(u="=",s%1);a+=u.charAt(63&t>>8-s%1*8)){if((n=o.charCodeAt(s+=.75))>255)throw new r;t=t<<8|n}return a}}),(function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}}),(function(e,t,n){"use strict";function r(){this.handlers=[]}var i=n(2);r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=r}),(function(e,t,n){"use strict";function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var i=n(2),o=n(52),a=n(25),s=n(14),u=n(53),c=n(54);e.exports=function(e){r(e),e.baseURL&&!u(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]}));return(e.adapter||s.adapter)(e).then((function(t){return r(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function(t){return a(t)||(r(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}}),(function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}}),(function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}}),(function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}}),(function(e,t,n){"use strict";function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e((function(e){n.reason||(n.reason=new i(e),t(n.reason))}))}var i=n(26);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r(function(t){e=t}),cancel:e}},e.exports=r}),(function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}}),(function(e,t,n){"use strict";function r(e){var t={baseURL:u.getSsoApiUrl(),headers:{"Content-Type":"application/json"}};return e&&(t.headers.Authorization="Bearer "+e.accessToken),t}function i(e){return new c.ApiResponse(200,e.data)}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(13),u=n(8),c=n(11);t.axiosInstance=s.default.create(),t.axiosInstance.interceptors.request.use((function(e){if(!e.baseURL)throw new Error("API Url not set");return e})),t.get=function(e){return o(this,void 0,void 0,(function(){var n;return a(this,(function(o){switch(o.label){case 0:return[4,t.axiosInstance.get(e,r())];case 1:return n=o.sent(),[2,i(n)]}}))}))},t.post=function(e,n,s){return o(this,void 0,void 0,(function(){var o,l;return a(this,(function(a){switch(a.label){case 0:n&&!n.client_id&&(n.client_id=u.getSsoClientId()),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.axiosInstance.post(e,n,r(s))];case 2:return o=a.sent(),[2,i(o)];case 3:return(l=a.sent()).response&&l.response.data&&l.response.data.status?[2,new c.ApiResponse(l.response.data.status,l.response.data)]:[2,new c.ApiResponse(500,{type:"error"})];case 4:return[2]}}))}))}}),(function(e,t,n){"use strict";function r(e,t){return a(this,void 0,void 0,(function(){var n,r,i;return s(this,(function(o){switch(o.label){case 0:return n=c.getStApiUrl(),-1===e.indexOf("places/list")&&(n=n.replace("api-cdn","api")),i={baseURL:n},[4,(function(){return a(this,void 0,void 0,(function(){var e,t,n;return s(this,(function(r){switch(r.label){case 0:return[4,l.getUserSession()];case 1:return e=r.sent(),t={},(n=c.getIntegratorKey())&&(t["x-api-key"]=n),e&&(t.Authorization="Bearer "+e.accessToken),[2,t]}}))}))})()];case 1:return i.headers=o.sent(),r=i,t&&(r.data=t),[2,r]}}))}))}function i(e){return new f.ApiResponse(e.data.status_code,e.data.data,e.data.server_timestamp)}function o(e){return e.response&&e.response.data&&e.response.data.error&&e.response.data.error.id&&"apikey.invalid"===e.response.data.error.id?(p&&p(),new Error("Invalid session")):e}var a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var u=n(13),c=n(8),l=n(4),f=n(11);t.axiosInstance=u.default.create(),t.axiosInstance.interceptors.request.use((function(e){if(!e.baseURL)throw new Error("API Url not set");return e}));var p;t.setInvalidSessionHandler=function(e){p=e},t.get=function(e){return a(this,void 0,void 0,(function(){var n,a,u,c,l;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),u=(a=t.axiosInstance).get,c=[e],[4,r(e)];case 1:return[4,u.apply(a,c.concat([s.sent()]))];case 2:return n=s.sent(),[2,i(n)];case 3:throw l=s.sent(),o(l);case 4:return[2]}}))}))},t.post=function(e,n){return a(this,void 0,void 0,(function(){var a,u,c,l,f;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),c=(u=t.axiosInstance).post,l=[e,n],[4,r(e)];case 1:return[4,c.apply(u,l.concat([s.sent()]))];case 2:return a=s.sent(),[2,i(a)];case 3:throw f=s.sent(),o(f);case 4:return[2]}}))}))},t.delete_=function(e,n){return a(this,void 0,void 0,(function(){var a,u,c,l,f;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),c=(u=t.axiosInstance).delete,l=[e],[4,r(e,n)];case 1:return[4,c.apply(u,l.concat([s.sent()]))];case 2:return a=s.sent(),[2,i(a)];case 3:throw f=s.sent(),o(f);case 4:return[2]}}))}))},t.put=function(e,n){return a(this,void 0,void 0,(function(){var a,u,c,l,f;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),c=(u=t.axiosInstance).put,l=[e,n],[4,r(e)];case 1:return[4,c.apply(u,l.concat([s.sent()]))];case 2:return a=s.sent(),[2,i(a)];case 3:throw f=s.sent(),o(f);case 4:return[2]}}))}))}}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(60),a=(function(){function e(){}return e.prototype.set=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){return o.set(e,JSON.stringify({value:t}),{expires:1/0}),[2]}))}))},e.prototype.get=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){return(t=o.get(e))?(n=JSON.parse(t),[2,n.value]):[2,null]}))}))},e.prototype.getAll=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error("getAll() not available for cookie cache")}))}))},e.prototype.getBatch=function(e){var t=this;return Promise.all(e.map((function(e){return t.get(e)})))},e.prototype.getBatchMap=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getBatch(e)];case 1:return t=n.sent(),[2,t.reduce((function(t,n,r){return t.set(e[r],n)}),new Map)]}}))}))},e.prototype.remove=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return o.remove(e),[2]}))}))},e.prototype.reset=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error("reset() not available for cookie cache")}))}))},e})();t.BrowserCookieCache=a}),(function(e,t,n){var r;!(function(i,o){"use strict";var a=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var t=function(e,n,r){return 1===arguments.length?t.get(e):t.set(e,n,r)};return t._document=e.document,t._cacheKeyPrefix="cookey.",t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),t.defaults={path:"/",secure:!1},t.get=function(e){t._cachedDocumentCookie!==t._document.cookie&&t._renewCache();var n=t._cache[t._cacheKeyPrefix+e];return void 0===n?void 0:decodeURIComponent(n)},t.set=function(e,n,r){return r=t._getExtendedOptions(r),r.expires=t._getExpiresDate(void 0===n?-1:r.expires),t._document.cookie=t._generateCookieString(e,n,r),t},t.expire=function(e,n){return t.set(e,void 0,n)},t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&void 0!==e.secure?e.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){if(n=n||new Date,"number"==typeof e?e=e===1/0?t._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){var r=(e=(e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent)).replace(/\(/g,"%28").replace(/\)/g,"%29"))+"="+(t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent));return r+=(n=n||{}).path?";path="+n.path:"",r+=n.domain?";domain="+n.domain:"",r+=n.expires?";expires="+n.expires.toUTCString():"",r+=n.secure?";secure":""},t._getCacheFromString=function(e){for(var n={},r=e?e.split("; "):[],i=0;i<r.length;i++){var o=t._getKeyValuePairFromCookieString(r[i]);void 0===n[t._cacheKeyPrefix+o.key]&&(n[t._cacheKeyPrefix+o.key]=o.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");t=t<0?e.length:t;var n,r=e.substr(0,t);try{n=decodeURIComponent(r)}catch(e){console&&"function"==typeof console.error&&console.error('Could not decode cookie with key "'+r+'"',e)}return{key:n,value:e.substr(t+1)}},t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){var e="cookies.js",n="1"===t.set(e,1).get(e);return t.expire(e),n},t.enabled=t._areEnabled(),t},s=i&&"object"==typeof i.document?a(i):a;void 0===(r=function(){return s}.call(t,n,t,e))||(e.exports=r)})("undefined"==typeof window?this:window)}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(15),a=(function(){function e(){this.cache={}}return e.prototype.set=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){return this.cache[e]=null!==t&&"object"==typeof t?o(t):t,[2]}))}))},e.prototype.get=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){return(t=this.cache[e])?[2,"object"==typeof t?o(t):t]:[2,null]}))}))},e.prototype.getAll=function(){return r(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,Object.keys(this.cache).map((function(t){return e.cache[t]}))]}))}))},e.prototype.getBatch=function(e){var t=this;return Promise.all(e.map((function(e){return t.get(e)})))},e.prototype.getBatchMap=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getBatch(e)];case 1:return t=n.sent(),[2,t.reduce((function(t,n,r){return t.set(e[r],n)}),new Map)]}}))}))},e.prototype.remove=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return delete this.cache[e],[2]}))}))},e.prototype.reset=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){return this.cache={},[2]}))}))},e})();t.InMemoryCache=a}),(function(e,t){var n;n=(function(){return this})();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n}),(function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}),(function(e,t,n){"use strict";function r(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,u.favoritesCache.remove(e)];case 1:return t.sent(),[2]}}))}))}function i(){return o(this,void 0,void 0,(function(){var e,t;return a(this,(function(n){switch(n.label){case 0:return[4,s.StApi.get("favorites")];case 1:if(!(e=n.sent()).data.favorites)throw new Error("Wrong API response");return t=e.data.favorites.map((function(e){return e.place_id})),[4,Promise.all(t.map((function(e){return u.favoritesCache.set(e,e)})))];case 2:return n.sent(),[2,t]}}))}))}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),u=n(9);t.getFavorites=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,u.favoritesCache.getAll()];case 1:return(e=t.sent()).length>0?[2,e]:[2,i()]}}))}))},t.addPlaceToFavorites=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,s.StApi.post("favorites",{place_id:e})];case 1:return t.sent(),u.favoritesCache.set(e,e),[2]}}))}))},t.addCustomPlaceToFavorites=function(e,t,n){return o(this,void 0,void 0,(function(){var r;return a(this,(function(i){switch(i.label){case 0:return[4,s.StApi.post("favorites/custom",{name:e,location:t,address:n})];case 1:return r=i.sent(),[2,r.data.favorite.place_id]}}))}))},t.removePlaceFromFavorites=function(e){return o(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return[4,s.StApi.delete_("favorites",{place_id:e})];case 1:return t=n.sent(),[4,r(e)];case 2:return n.sent(),[2,t]}}))}))},t.shouldNotifyOnFavoritesUpdate=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,u.favoritesCache.get(e)];case 1:return t.sent()?[2,!1]:[4,i()];case 2:return t.sent(),[2,!0]}}))}))},t.isFavoriteInCache=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,u.favoritesCache.get(e)];case 1:return[2,!!t.sent()]}}))}))},t.removeFavoriteFromCache=r}),(function(e,t,n){"use strict";function r(e,t){return i(this,void 0,void 0,(function(){var n,r,a,l,p=this;return o(this,(function(d){switch(d.label){case 0:return n=[],r=[],a=[],[4,Promise.all(e.map((function(e){return i(p,void 0,void 0,(function(){var t;return o(this,(function(r){switch(r.label){case 0:return[4,c.placesDetailedCache.get(e)];case 1:return(t=r.sent())?n.push(t):a.push(e),[2]}}))}))})))];case 1:return d.sent(),a.length>0?[4,(function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,u.StApi.get("places?"+s.stringify({ids:e.join("|")}))];case 1:if(!(t=n.sent()).data.hasOwnProperty("places"))throw new Error("Wrong API response");return[2,t.data.places]}}))}))})(a)]:[3,4];case 2:return r=d.sent(),[4,Promise.all(r.map((function(e){return i(p,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,c.placesDetailedCache.set(e.id,e)];case 1:return t.sent(),[2]}}))}))})))];case 3:d.sent(),d.label=4;case 4:return l=e.reduce((function(e,t){var i=n.find((function(e){return e.id===t}));i&&e.push(i);var o=r.find((function(e){return e.id===t}));return o&&e.push(o),e}),[]),[2,f.mapPlaceDetailedBatchApiResponseToPlaces(l,t)]}}))}))}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),s=n(7),u=n(0),c=n(9),l=n(1),f=n(18);t.getPlaces=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return e.mapSpread?[4,(function(e){return i(this,void 0,void 0,(function(){var t,n,r,a,s,c,f,p,d=this;return o(this,(function(h){switch(h.label){case 0:for(t=l.boundsToMapTileKeys(e.bounds,e.zoom),n=[],r=function(t){var r=e.cloneSetBounds(null);r=(r=r.cloneSetLimit(32)).cloneSetMapTiles([t]);var a=new Promise(function(e){return i(d,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=e,[4,u.StApi.get("places/list?"+r.toQueryString())];case 1:return t.apply(void 0,[n.sent()]),[3,3];case 2:return n.sent(),e(new u.ApiResponse(200,{places:[]})),[3,3];case 3:return[2]}}))}))});n.push(a)},a=0,s=t;a<s.length;a++)c=s[a],r(c);return[4,Promise.all(n)];case 1:return f=h.sent(),p=f.reduce((function(e,t){return e.statusCode=t.statusCode,e.data.places=e.data.places.concat(t.data.places),e}),new u.ApiResponse(200,{places:[]})),p.data.places=p.data.places.sort((function(e,t){return e.rating>t.rating?-1:1})),[2,p]}}))}))})(e)]:[3,2];case 1:return n=r.sent(),[3,4];case 2:return[4,u.StApi.get("places/list?"+e.toQueryString())];case 3:n=r.sent(),r.label=4;case 4:if(!(t=n).data.hasOwnProperty("places"))throw new Error("Wrong API response");return[2,f.mapPlaceApiResponseToPlaces(t.data.places)]}}))}))},t.getPlaceDetailed=function(e,t){return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return n=null,[4,c.placesDetailedCache.get(e)];case 1:return(r=o.sent())?[3,4]:[4,u.StApi.get("places/"+e)];case 2:if(!(i=o.sent()).data.hasOwnProperty("place"))throw new Error("Wrong API response");return n=i.data.place,[4,c.placesDetailedCache.set(e,n)];case 3:return o.sent(),[3,5];case 4:n=r,o.label=5;case 5:return[2,f.mapPlaceDetailedApiResponseToPlace(n,t)]}}))}))},t.createCustomPlace=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return[4,u.StApi.post("places",e)];case 1:if(!(t=r.sent()).data.hasOwnProperty("place"))throw new Error("Wrong API response");return n=t.data.place,[4,c.placesDetailedCache.set(n.id,n)];case 2:return r.sent(),[2,f.mapPlaceDetailedApiResponseToPlace(n,"100x100")]}}))}))},t.updateCustomPlace=function(e,t){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:return[4,u.StApi.put("places/"+e,t)];case 1:if(!(n=i.sent()).data.hasOwnProperty("place"))throw new Error("Wrong API response");return r=n.data.place,[4,c.placesDetailedCache.set(r.id,r)];case 2:return i.sent(),[2,f.mapPlaceDetailedApiResponseToPlace(r,"100x100")]}}))}))},t.deleteCustomPlace=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,u.StApi.delete_("places/"+e,{})];case 1:return t.sent(),[4,c.placesDetailedCache.remove(e)];case 2:return t.sent(),[2]}}))}))},t.getPlacesDetailed=r,t.getPlacesFromTripDay=function(e,t){return i(this,void 0,void 0,(function(){var n;return o(this,(function(i){return n=e.itinerary.map((function(e){return e.placeId})),[2,r(n,t)]}))}))},t.getPlaceMedia=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,u.StApi.get("places/"+e+"/media")];case 1:if(!(t=n.sent()).data.hasOwnProperty("media"))throw new Error("Wrong API response");return[2,t.data.media.map((function(e){return a.camelizeKeys(e)}))]}}))}))},t.getPlaceGeometry=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,u.StApi.get("places/"+e+"/geometry")];case 1:if(!(t=n.sent()).data.hasOwnProperty("geometry")||!t.data.hasOwnProperty("is_shape"))throw new Error("Wrong API response");return[2,f.mapPlaceGeometryApiResponseToPlaceGeometry(t.data)]}}))}))},t.getPlaceOpeningHours=function(e,t,n){return i(this,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return[4,u.StApi.get("places/"+e+"/opening-hours?"+s.stringify({from:t,to:n}))];case 1:if(!(r=i.sent()).data.hasOwnProperty("opening_hours"))throw new Error("Wrong API response");return[2,f.mapPlaceOpeningHours(r.data.opening_hours)]}}))}))},t.addPlaceReview=function(e,t,n){return i(this,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return[4,u.StApi.post("reviews",{place_id:e,rating:t,message:n})];case 1:if(!(r=i.sent()).data.hasOwnProperty("review"))throw new Error("Wrong API response");return[2,f.mapPlaceReview(r.data.review)]}}))}))},t.deletePlaceReview=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,u.StApi.delete_("reviews/"+e,null)];case 1:return t.sent(),[2]}}))}))},t.getPlaceReviews=function(e,t,n){return i(this,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return[4,u.StApi.get("places/"+e+"/reviews?"+s.stringify({limit:t,page:n}))];case 1:if(!(r=i.sent()).data.hasOwnProperty("reviews")||!r.data.hasOwnProperty("rating")||!r.data.hasOwnProperty("current_user_has_review"))throw new Error("Wrong API response");return[2,f.mapPlaceReviewsData(r.data)]}}))}))},t.voteOnReview=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,u.StApi.put("reviews/"+e+"/votes",{value:t})];case 1:return n.sent(),[2]}}))}))},t.detectParentsByBounds=function(e,t){return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return n=l.locationToMapTileKey({lat:e.south,lng:e.west},t),r=l.locationToMapTileKey({lat:e.north,lng:e.east},t),[4,u.StApi.get("places/detect-parents/main-in-bounds?"+s.stringify({map_tile_bounds:n+","+r}))];case 1:if(!(i=o.sent()).data.hasOwnProperty("places"))throw new Error("Wrong API response");return[2,f.mapPlaceApiResponseToPlaces(i.data.places)]}}))}))},t.detectParentsByLocation=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,u.StApi.get("places/detect-parents?"+s.stringify({location:e.lat+","+e.lng}))];case 1:if(!(t=n.sent()).data.hasOwnProperty("places"))throw new Error("Wrong API response");return[2,f.mapPlaceApiResponseToPlaces(t.data.places)]}}))}))},t.getPlacesStats=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return e.bounds&&(e=e.switchBoundsToMapTileBounds()),[4,u.StApi.get("places/stats?"+e.toQueryString())];case 1:if(!(t=n.sent()).data.hasOwnProperty("stats"))throw new Error("Wrong API response");return[2,{categories:t.data.stats.categories.map((function(e){return a.camelizeKeys(e)})),tags:t.data.stats.tags.map((function(e){return a.camelizeKeys(e)}))}]}}))}))}}),(function(e,t,n){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}}),(function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=(function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}})()?Object.assign:function(e,t){for(var n,a,s=(function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)})(e),u=1;u<arguments.length;u++){n=Object(arguments[u]);for(var c in n)i.call(n,c)&&(s[c]=n[c]);if(r){a=r(n);for(var l=0;l<a.length;l++)o.call(n,a[l])&&(s[a[l]]=n[a[l]])}}return s}}),(function(e,t,n){"use strict";function r(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],r(n),r(i))}function i(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(o),n=1;n<t.length;n++)t=(e=r(t,n).join("")).match(o);return e}}var o=new RegExp("%[a-f0-9]{2}","gi"),a=new RegExp("(%[a-f0-9]{2})+","gi");e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return (function(e){for(var t={"%FE%FF":"","%FF%FE":""},n=a.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var r=i(n[0]);r!==n[0]&&(t[n[0]]=r)}n=a.exec(e)}t["%C2"]="";for(var o=Object.keys(t),s=0;s<o.length;s++){var u=o[s];e=e.replace(new RegExp(u,"g"),t[u])}return e})(e)}}}),(function(e,t,n){"use strict";function r(e,t,n){var r=Math.sqrt(t*t+n*n),a=i.toDegrees(Math.asin(n/r)),s=o.locationWithOffset(e,r,270-a),u=o.locationWithOffset(e,r,90-a);return{south:s.lat,west:s.lng,north:u.lat,east:u.lng}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(27);t.getZoomFromBounds=function(e,t){var n=e.east-e.west;return Math.round(Math.log(360*t/n/256)/Math.LN2)},t.isLocationInBounds=function(e,t){return e.lat>=t.south&&e.lat<=t.north&&e.lng>=t.west&&e.lng<=t.east},t.calculateLocationsBounds=function(e){if(1===e.length)return r(e[0],2e3,2e3);var t={south:-1/0,west:-1/0,north:-1/0,east:-1/0};return e.forEach((function(e){var n=e.lat,r=e.lng;t.north===-1/0&&(t.north=n,t.east=r),t.south===-1/0&&(t.south=n,t.west=r),t.north<n&&(t.north=n),t.east<r&&(t.east=r),t.south>n&&(t.south=n),t.west>r&&(t.west=r)})),t},t.createBoundsFromLocationAndSize=r}),(function(e,t,n){"use strict";function r(e,t){if(e=o({},e),e.west=a.normalizeLng(e.west),e.east=a.normalizeLng(e.east),e.west>e.east){var n={south:e.south,west:e.west,north:e.north,east:179.99999},s={south:e.south,west:-180,north:e.north,east:e.east};return r(n,t).concat(r(s,t))}for(var u=a.locationToTileCoordinate({lat:e.north,lng:e.east},t),c=a.locationToTileCoordinate({lat:e.south,lng:e.west},t),l={x:u.x,y:u.y},f=[];l.y<=c.y;){for(;l.x>=c.x;)f.push(i(l,t)),l.x-=1;l.y+=1,l.x=u.x}return f}function i(e,t){for(var n="",r=t;r>0;r--){var i=0,o=1<<r-1;0!=(e.x&o)&&(i+=1),0!=(e.y&o)&&(i+=2),n+=i.toString()}return n}var o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var a=n(1);t.boundsToMapTileKeys=r,t.locationToMapTileKey=function(e,t){return i(a.locationToTileCoordinate(e,t),t)}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EARTH_RADIUS=6378137,t.getDistance=function(e,t,n){var r=e.lat*Math.PI/180,i=e.lng*Math.PI/180,o=t.lat*Math.PI/180,a=t.lng*Math.PI/180;return Math.round(Math.acos(Math.sin(r)*Math.sin(o)+Math.cos(r)*Math.cos(o)*Math.cos(a-i))*n)}}),(function(e,t,n){"use strict";var r=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})();Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(t){var n=e.call(this,t)||this;return n._limit=t.limit,n._mapSpread=t.mapSpread,n.validate(),n}return r(t,e),t.prototype.cloneSetBounds=function(e){var t=Object.create(this);return Object.assign(t,this,{_bounds:e})},t.prototype.cloneSetMapTiles=function(e){var t=Object.create(this);return Object.assign(t,this,{_mapTiles:e})},t.prototype.cloneSetLimit=function(e){var t=Object.create(this);return Object.assign(t,this,{_limit:e})},t.prototype.toQueryObject=function(){var t=e.prototype.toQueryObject.call(this);return this._mapSpread&&(t.map_spread=this._mapSpread),this._limit&&(t.limit=this._limit),t},Object.defineProperty(t.prototype,"mapSpread",{get:function(){return this._mapSpread||null},enumerable:!0,configurable:!0}),t.prototype.validate=function(){if(e.prototype.validate.call(this),this._mapSpread){if(this._limit)throw new Error("Do not use limit with mapSpread.");if(!this._bounds)throw new Error("Bounds must be specified when calling with mapSpread.");if(!this._zoom)throw new Error("Zoom must be specified when calling with mapSpread.")}},t})(n(28).PlacesFilter);t.PlacesListFilter=i}),(function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var c=e.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var f,p,d,h,v=e[l].replace(s,"%20"),y=v.indexOf(n);y>=0?(f=v.substr(0,y),p=v.substr(y+1)):(f=v,p=""),d=decodeURIComponent(f),h=decodeURIComponent(p),r(a,d)?i(a[d])?a[d].push(h):a[d]=[a[d],h]:a[d]=h}return a};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}),(function(e,t,n){"use strict";function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?r(a(e),(function(a){var s=encodeURIComponent(i(a))+n;return o(e[a])?r(e[a],(function(e){return s+encodeURIComponent(i(e))})).join(t):s+encodeURIComponent(i(e[a]))})).join(t):s?encodeURIComponent(i(s))+n+encodeURIComponent(i(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isStickyByDefault=function(e){return-1!==e.categories.indexOf("sleeping")},t.hasTag=function(e,t){return!!t.tags.find((function(t){return t.key===e}))}}),(function(e,t,n){"use strict";var r=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})();Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=(function(e){function t(t){var n=e.call(this,t)||this;return n._mapTileBounds=t.mapTileBounds,n.validate(),n}return r(t,e),t.prototype.switchBoundsToMapTileBounds=function(){var e=Object.create(this);if(!this._bounds||!this._zoom)return Object.assign(e,this,{_mapTileBounds:null});var t=i.locationToMapTileKey({lat:this._bounds.south,lng:this._bounds.west},this._zoom),n=i.locationToMapTileKey({lat:this._bounds.north,lng:this._bounds.east},this._zoom);return Object.assign(e,this,{_bounds:null,_mapTileBounds:[t,n]})},t.prototype.toQueryObject=function(){var t=e.prototype.toQueryObject.call(this);return this._mapTileBounds&&(t.map_tile_bounds=this._mapTileBounds.join(",")),t},t.prototype.validate=function(){if(e.prototype.validate.call(this),this._bounds&&!this._zoom)throw new Error("Zoom must be specified when calling with bounds.")},t})(n(28).PlacesFilter);t.PlacesStatsFilter=o}),(function(e,t,n){"use strict";function r(e){return a(this,void 0,void 0,(function(){var t,n,r,i;return s(this,(function(c){switch(c.label){case 0:return t=y.get(e),y.delete(e),t?[4,o(t.apiData)]:[2];case 1:return n=c.sent(),clearTimeout(t.timeout),"ignored"===n.data.conflict_resolution?(r=u.camelizeKeys(n.data.conflict_info),[2,(function(e,t,n){return a(this,void 0,void 0,(function(){var r,i;return s(this,(function(a){switch(a.label){case 0:return(r=p.getTripConflictHandler())?[3,2]:[4,f.tripsDetailedCache.set(n.data.trip.id,n.data.trip)];case 1:return a.sent(),[2];case 2:return[4,r(e,t)];case 3:return"local"!==a.sent()?[3,5]:(i=v.mapTripToApiUpdateFormat(t),i.updated_at=h.dateToW3CString(new Date),[4,o(i)]);case 4:n=a.sent(),a.label=5;case 5:return[4,f.tripsDetailedCache.set(n.data.trip.id,n.data.trip)];case 6:return a.sent(),[2]}}))}))})(r,t.trip,n)]):(i=y.get(e))?(i.apiData.base_version=n.data.trip.version,[3,4]):[3,2];case 2:return[4,f.tripsDetailedCache.set(n.data.trip.id,n.data.trip)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function i(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return[4,l.StApi.get("trips/"+e)];case 1:if(!(t=n.sent()).data.hasOwnProperty("trip"))throw new Error("Wrong API response");return[4,f.tripsDetailedCache.set(e,t.data.trip)];case 2:return n.sent(),[2,t.data.trip]}}))}))}function o(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return[4,l.StApi.put("trips/"+e.id,e)];case 1:if(!(t=n.sent()).data.hasOwnProperty("trip"))throw new Error("Wrong API response");return[2,t]}}))}))}var a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var u=n(3),c=n(7),l=n(0),f=n(9),p=n(8),d=n(4),h=n(6),v=n(19),y=new Map,g=3e3;t.getTrips=function(e,t){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return n={},null!==e&&(n.from=e),null!==t&&(n.to=t),[4,l.StApi.get("trips/list?"+c.stringify(n))];case 1:if(!(r=i.sent()).data.hasOwnProperty("trips"))throw new Error("Wrong API response");return[2,v.mapTripListApiResponseToTripsList(r.data.trips)]}}))}))},t.getTripsInTrash=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,l.StApi.get("trips/trash")];case 1:if(!(e=t.sent()).data.hasOwnProperty("trips"))throw new Error("Wrong API response");return[2,v.mapTripListApiResponseToTripsList(e.data.trips)]}}))}))},t.getTripDetailed=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o;return s(this,(function(a){switch(a.label){case 0:return t=null,[4,f.tripsDetailedCache.get(e)];case 1:return(n=a.sent())?[3,3]:[4,i(e)];case 2:return t=a.sent(),f.tripsDetailedCache.set(e,t),[3,4];case 3:t=n,a.label=4;case 4:return r=v.mapTripDetailedApiResponseToTrip,o=[t],[4,d.getUserSettings()];case 5:return[2,r.apply(void 0,o.concat([a.sent()]))]}}))}))},t.createTrip=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i;return s(this,(function(o){switch(o.label){case 0:return[4,l.StApi.post("trips",v.mapTripCreateRequestToApiFormat(e))];case 1:if(!(t=o.sent()).data.hasOwnProperty("trip"))throw new Error("Wrong API response");return n=t.data.trip,[4,f.tripsDetailedCache.set(n.id,n)];case 2:return o.sent(),r=v.mapTripDetailedApiResponseToTrip,i=[n],[4,d.getUserSettings()];case 3:return[2,r.apply(void 0,i.concat([o.sent()]))]}}))}))},t.updateTrip=function(e){return a(this,void 0,void 0,(function(){var t,n,i,o,u=this;return s(this,(function(c){switch(c.label){case 0:return t=v.mapTripToApiFormat(e),[4,f.tripsDetailedCache.set(e.id,t)];case 1:return c.sent(),(n=y.get(e.id))&&clearTimeout(n.timeout),i=v.mapTripToApiUpdateFormat(e),i.updated_at=h.dateToW3CString(new Date),o={apiData:i,trip:e,timeout:setTimeout((function(){return a(u,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,r(e.id)];case 1:return t.sent(),[2]}}))}))}),g)},y.set(e.id,o),[2,e]}}))}))},t.syncChangedTripToServer=r,t.shouldNotifyOnTripUpdate=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return[4,f.tripsDetailedCache.get(e)];case 1:return(n=r.sent())&&n.version===t?[2,!1]:n?[4,i(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2,!0]}}))}))},t.isTripInCache=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,f.tripsDetailedCache.get(e)];case 1:return[2,!!t.sent()]}}))}))},t.deleteTripFromCache=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,f.tripsDetailedCache.remove(e)]}))}))},t.cloneTrip=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return[4,l.StApi.post("trips/clone",{trip_id:e})];case 1:if(!(t=n.sent()).data.hasOwnProperty("trip_id"))throw new Error("Wrong API response");return[2,t.data.trip_id]}}))}))},t.emptyTripsTrash=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,l.StApi.delete_("trips/trash",null)];case 1:if(!(e=t.sent()).data.hasOwnProperty("deleted_trip_ids"))throw new Error("Wrong API response");return[2,e.data.deleted_trip_ids]}}))}))},t.getTripTemplates=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return[4,l.StApi.get("trip-templates?"+c.stringify({place_id:e}))];case 1:if(!(t=r.sent()).data.hasOwnProperty("trip_templates"))throw new Error("Wrong API response");return[4,d.getUserSettings()];case 2:return n=r.sent(),[2,t.data.trip_templates.map((function(e){return v.mapTripTemplateApiResponse(e,n)}))]}}))}))},t.applyTripTemplate=function(e,t,n){return a(this,void 0,void 0,(function(){var r,i,o;return s(this,(function(a){switch(a.label){case 0:return[4,l.StApi.put("/trips/"+e+"/apply-template",{template_id:t,day_index:n})];case 1:if(!(r=a.sent()).data.hasOwnProperty("trip"))throw new Error("Wrong API response");return[4,f.tripsDetailedCache.set(r.data.trip.id,r.data.trip)];case 2:return a.sent(),i=v.mapTripDetailedApiResponseToTrip,o=[r.data.trip],[4,d.getUserSettings()];case 3:return[2,i.apply(void 0,o.concat([a.sent()]))]}}))}))}}),(function(e,t,n){"use strict";function r(e,t,n,r,i){if(o(e,n),void 0!==i&&null!==i&&(e.days[n].itinerary.length<i||i<0))throw new Error("Invalid positionInDay");var a=s(e),c={place:t,placeId:t.id,startTime:null,duration:null,isSticky:!1,isStickyFirstInDay:!1,isStickyLastInDay:!1,note:null,transportFromPrevious:null};void 0!==i&&null!==i||(i=a.days[n].itinerary.length);var l=null;return e.days[n].itinerary[i]&&(l=e.days[n].itinerary[i]),l&&l.transportFromPrevious&&!u.UNBREAKABLE_TRANSPORT_MODES.includes(l.transportFromPrevious.mode)&&(c.transportFromPrevious=s(l.transportFromPrevious),c.transportFromPrevious.waypoints=[]),a.days[n].itinerary.splice(i,0,c),f.resolveStickiness(a,r)}function i(e,t,n,r){o(e,t),n.forEach((function(n){if(e.days&&!e.days[t].itinerary[n])throw new Error("Invalid positionInDay")}));var i=s(e);return i.days[t].itinerary=i.days[t].itinerary.filter((function(e,t){return n.indexOf(t)<0})),f.resolveStickiness(i,r)}function o(e,t,n){if(void 0===n&&(n="dayIndex"),!e.days)throw new Error("days property in Trip cannot be null");if(!e.days[t])throw new Error("Invalid "+n);return!0}function a(e,t,n,r){if(void 0===r&&(r="itemIndex"),o(e,t),!e.days[t].itinerary[n])throw new Error("Invalid "+r);return!0}Object.defineProperty(t,"__esModule",{value:!0});var s=n(15),u=n(10),c=n(5),l=n(6),f=n(19),p=n(30);t.addDay=function(e,t){if(!e.days)throw new Error("days property in Trip cannot be null");if(!e.endsOn)throw new Error("endsOn property in Trip cannot be null");var n=s(e);if(n.days.push({itinerary:[],note:null,date:null}),n.endsOn=n.endsOn?l.addDaysToDate(n.endsOn,1):n.endsOn,n.days=p.decorateDaysWithDate(n.startsOn,n.days),n.days[n.days.length-2].itinerary.length>0){var i=n.days[n.days.length-2].itinerary[n.days[n.days.length-2].itinerary.length-1];c.isStickyByDefault(i.place)&&(n=r(n,i.place,n.days.length-1,t,0))}return f.resolveStickiness(n,t)},t.prependDayToTrip=function(e,t){if(!e.days)throw new Error("days property in Trip cannot be null");var n=s(e);if(n.days.unshift({itinerary:[],note:null,date:null}),n.startsOn=l.subtractDaysFromDate(n.startsOn,1),n.days=p.decorateDaysWithDate(n.startsOn,n.days),n.days[1].itinerary.length>0){var i=n.days[1].itinerary[0];c.isStickyByDefault(i.place)&&(n=r(n,i.place,0,t,0))}return f.resolveStickiness(n,t)},t.removeDayFromTrip=function(e,t,n){o(e,t);var r=s(e);return 0===t&&r.startsOn?r.startsOn=l.addDaysToDate(r.startsOn,1):r.endsOn=l.subtractDaysFromDate(r.endsOn,1),r.days.splice(t,1),r.days=p.decorateDaysWithDate(r.startsOn,r.days),f.resolveStickiness(r,n)},t.swapDaysInTrip=function(e,t,n,r){o(e,t,"firstDayIndex"),o(e,n,"secondDayIndex");var i=s(e),a=i.days[t],u=i.days[n];return i.days[t]=u,i.days[n]=a,f.resolveStickiness(i,r)},t.setTransport=function(e,t,n,r){a(e,t,n);var i=s(e);return i.days[t].itinerary[n].transportFromPrevious=r,i},t.updateItineraryItemUserData=function(e,t,n,r,i,o){a(e,t,n);var u=s(e);return u.days[t].itinerary[n].startTime=r,u.days[t].itinerary[n].duration=i,u.days[t].itinerary[n].note=o,u},t.updateDayNote=function(e,t,n){o(e,t);var r=s(e);return r.days[t].note=n,r},t.addPlaceToDay=r,t.duplicateItineraryItem=function(e,t,n,r){void 0===r&&(r=!1),a(e,t,n);var i=s(e),o=s(i.days[t].itinerary[n]);return r&&(o.transportFromPrevious=null),i.days[t].itinerary.splice(n+1,0,o),i},t.movePlaceInDay=function(e,t,n,r,i){a(e,t,n,"positionFrom"),a(e,t,r,"positionTo");var o=s(e),u=o.days[t].itinerary[n];return o.days[t].itinerary.splice(n,1),o.days[t].itinerary.splice(r,0,u),f.resolveStickiness(o,i)},t.removePlacesFromDay=i,t.removeAllPlacesFromDay=function(e,t,n){o(e,t);var r=s(e);return r.days[t].itinerary=[],f.resolveStickiness(r,n)},t.replaceLastStickyPlace=function(e,t,n,a){o(e,n);var u=s(e);e.days[n].itinerary.length&&e.days[n].itinerary[e.days[n].itinerary.length-1].isSticky&&(u=r(u=i(u,n,[u.days[n].itinerary.length-1],a),t,n,a,u.days[n].itinerary.length));var c=n+1;return e.days[c]&&e.days[c].itinerary.length&&e.days[c].itinerary[0].isSticky&&(u=r(u=i(u,c,[0],a),t,c,a,0)),f.resolveStickiness(u,a)},t.addOrReplaceOvernightPlace=function(e,t,n,a){o(e,n);var u=s(e);e.days[n].itinerary.length&&e.days[n].itinerary[e.days[n].itinerary.length-1].isSticky&&(u=i(u,n,[u.days[n].itinerary.length-1],a));var c=n+1;return e.days[c]&&e.days[c].itinerary.length&&e.days[c].itinerary[0].isSticky&&(u=i(u,c,[0],a)),0!==u.days[n].itinerary.length&&u.days[n].itinerary[u.days[n].itinerary.length-1].placeId===t.id||(u=r(u,t,n,a,u.days[n].itinerary.length)),!u.days[c]||0!==u.days[c].itinerary.length&&u.days[c].itinerary[0].placeId===t.id||(u=r(u,t,c,a,0)),f.resolveStickiness(u,a)},t.removePlaceFromDayByPlaceId=function(e,t,n,r){o(e,n);var i=s(e);return i.days[n].itinerary=i.days[n].itinerary.filter((function(e){return e.placeId!==t})),f.resolveStickiness(i,r)}}),(function(e,t,n){"use strict";function r(e){return!(!e.transportFromPrevious||!i.UNBREAKABLE_TRANSPORT_MODES.includes(e.transportFromPrevious.mode))}Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),o=n(1),a=n(5);t.getAddToTripInstructions=function(e,t,n,i,s){var u=0,c=[],l=!1,f=t.days[n].itinerary;if(a.isStickyByDefault(e)&&(!f.length||!f[f.length-1].isSticky))return{position:f.length,shouldDuplicate:!1};if(0===n&&(e.id===s.homePlaceId||e.id===s.workPlaceId))return{position:0,shouldDuplicate:!1};if(n===t.days.length-1&&(e.id===s.homePlaceId||e.id===s.workPlaceId))return{position:t.days[n].itinerary.length,shouldDuplicate:!1};if(0===n&&1===f.length&&(f[0].placeId===s.homePlaceId||f[0].placeId===s.workPlaceId))return{position:1===t.days.length?0:1,shouldDuplicate:1===t.days.length};for(;u<f.length;){var p={penalty:0,shouldSplit:!1},d=f[u],h=d.place.parents.filter((function(e){return i.includes(e)}));0!==h.length||l||(p.penalty+=10),(r(d)||d.isSticky&&0===u)&&(p.penalty+=10,p.shouldSplit=!0),c.push(p),l=0!==h.length,++u===f.length&&(p={penalty:0,shouldSplit:!1},0===h.length&&(p.penalty+=10),t.days[n+1]&&t.days[n+1].itinerary[0]&&r(t.days[n+1].itinerary[0])&&(p.penalty+=30,p.shouldSplit=!1),d.isSticky&&(p.penalty=30,p.shouldSplit=!1),c.push(p))}for(var v=c.reduce((function(e,t){return t.penalty<e?t.penalty:e}),1/0),y=f.map((function(e){return e.place.location})),g=0,b=1/0,w=y.length,m=function(){var t=y.slice();if(c[g].penalty!==v)return g++,"continue";t.splice(g,0,e.location);var n,r=t.reduce((function(e,t){return n&&(e+=o.getDistance(n,t,o.EARTH_RADIUS)),n=t,e}),0);r<=b&&(w=g,b=r),g++};g<c.length;)m();return{position:w,shouldDuplicate:!!c[w]&&c[w].shouldSplit}}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=r.listToEnum(["car","pedestrian","bike","plane","bus","train","boat"]);t.isTransportMode=function(e){return"string"==typeof e&&i[e]===e},t.UNBREAKABLE_TRANSPORT_MODES=["plane","bus","train","boat"];var o=r.listToEnum(["tolls","highways","ferries","unpaved"]);t.isTransportAvoid=function(e){return"string"==typeof e&&o[e]===e};var a=r.listToEnum(["merged","duplicated","ignored","overrode"]);t.isTripConflictResolution=function(e){return"string"==typeof e&&a[e]===e};var s=r.listToEnum(["server","local"]);t.isTripConflictClientResolution=function(e){return"string"==typeof e&&s[e]===e}}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=n(0),s=n(4),u=(function(){function e(e,t){this.tickInterval=e,this.callback=t}return e.prototype.start=function(){return r(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){switch(t.label){case 0:return this.changeWatchTicker?[2]:[4,this.checkChanges()];case 1:return t.sent(),this.changeWatchTicker=setInterval((function(){return e.checkChanges()}),this.tickInterval),[2]}}))}))},e.prototype.checkChanges=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return[4,s.getUserSession()];case 1:return t.sent()?[4,this.getChangesFromApi()]:[2];case 2:return(e=t.sent()).length>0?[4,this.callback(e)]:[3,4];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},e.prototype.getChangesFromApi=function(){return r(this,void 0,void 0,(function(){var e,t,n;return i(this,(function(r){switch(r.label){case 0:return e=[],t=this.lastServerTimestamp?"changes?"+o.stringify({since:this.lastServerTimestamp}):"changes",[4,a.StApi.get(t)];case 1:if((n=r.sent()).serverTimestamp&&(this.lastServerTimestamp=n.serverTimestamp),!n.data.hasOwnProperty("changes"))throw new Error("Changes error");return n.data.changes.length>0&&n.data.changes.forEach((function(t){e.push({id:t.id,type:t.type,change:t.change,version:t.version?t.version:null})})),[2,e]}}))}))},e.prototype.kill=function(){clearInterval(this.changeWatchTicker),this.changeWatchTicker=null},e.prototype.reset=function(){this.lastServerTimestamp=null},e})();t.default=u}),(function(e,t,n){"use strict";function r(e,t,n){return s(this,void 0,void 0,(function(){var i,o,s;return u(this,(function(u){switch(u.label){case 0:return[4,a()];case 1:return i=u.sent(),o={username:e,email_is_verified:!1,email:e,password:t,name:n},[4,l.SsoApi.post("user/register",o,i)];case 2:return 200===(s=u.sent()).statusCode?[2,"OK"]:401!==s.statusCode?[3,4]:[4,a()];case 3:return u.sent(),[2,r(e,t,n)];case 4:if(409===s.statusCode)return[2,"ERROR_ALREADY_REGISTERED"];if(s.data&&s.data.type)switch(s.data.type){case"validation.password.min_length":return[2,"ERROR_PASSWORD_MIN_LENGTH"];case"validation.username.min_length":case"validation.email.invalid_format":return[2,"ERROR_EMAIL_INVALID_FORMAT"];default:return[2,"ERROR"]}return[2,"ERROR"]}}))}))}function i(e){return s(this,void 0,void 0,(function(){var t,n,r;return u(this,(function(i){switch(i.label){case 0:return[4,l.SsoApi.post("oauth2/token",e)];case 1:return t=i.sent(),n=new Date,200===t.statusCode?[2,{code:"OK",session:{accessToken:t.data.access_token,refreshToken:t.data.refresh_token,expirationTimestamp:n.getTime()+1e3*t.data.expires_in,suggestedRefreshTimestamp:n.getTime()+500*t.data.expires_in}}]:(r="ERROR",401===t.statusCode&&(r="ERROR_INVALID_CREDENTIALS"),[2,{code:r,session:null}])}}))}))}function o(){return s(this,void 0,void 0,(function(){var e,t;return u(this,(function(n){switch(n.label){case 0:return[4,l.StApi.get("users/me")];case 1:if(!(e=n.sent()).data.hasOwnProperty("settings"))throw new Error("Wrong API response");return t=e.data.settings,[4,f.userCache.set(p,t)];case 2:return n.sent(),[2,t]}}))}))}function a(){return s(this,void 0,void 0,(function(){var e,t;return u(this,(function(n){switch(n.label){case 0:return[4,f.sessionCache.get(d)];case 1:return(e=n.sent())?[3,3]:[4,i({grant_type:"client_credentials"})];case 2:if(!(t=n.sent()).session)throw new Error("Unable to login client. Please check ssoClientId in settings.");e=t.session,n.label=3;case 3:return[4,f.sessionCache.set(d,e)];case 4:return n.sent(),[2,e]}}))}))}var s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var c=n(3),l=n(0),f=n(9),p="settings",d="client_session",h="user_session";t.getUserSettings=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,f.userCache.get(p)];case 1:return(e=t.sent())?[3,3]:[4,o()];case 2:e=t.sent(),t.label=3;case 3:return[2,c.camelizeKeys(e)]}}))}))},t.getUserSession=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){return[2,f.sessionCache.get(h)]}))}))},t.setUserSession=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){return[2,f.sessionCache.set(h,e)]}))}))},t.updateUserSettings=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=c.decamelizeKeys(e),[4,f.userCache.set(p,t)];case 1:return n.sent(),[4,l.StApi.put("users/me",t)];case 2:return n.sent(),[2,e]}}))}))},t.handleSettingsChange=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,o()];case 1:return e.sent(),[2]}}))}))},t.getSessionWithDeviceId=function(e,t){return s(this,void 0,void 0,(function(){var n;return u(this,(function(r){return n={grant_type:"client_credentials",device_code:e,device_platform:t},[2,i(n)]}))}))},t.getSessionWithJwt=function(e,t,n){return s(this,void 0,void 0,(function(){var r;return u(this,(function(o){return r={grant_type:"external",token:e},n&&(r.device_platform=n),t&&(r.device_code=t),[2,i(r)]}))}))},t.getSessionWithRefreshToken=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){return t={grant_type:"refresh_token",refresh_token:e},[2,i(t)]}))}))},t.getSessionWithThirdPartyAuth=function(e,t,n,r,o){return s(this,void 0,void 0,(function(){var a;return u(this,(function(s){if(t&&n)throw new Error("Only one of accessToken, authorizationCode must be provided");return a={grant_type:e},t&&(a.access_token=t),n&&(a.authorization_code=n),o&&(a.device_platform=o),r&&(a.device_code=r),[2,i(a)]}))}))},t.getSessionWithPassword=function(e,t,n,r){return s(this,void 0,void 0,(function(){var o;return u(this,(function(a){return o={grant_type:"password",username:e,password:t},r&&(o.device_platform=r),n&&(o.device_code=n),[2,i(o)]}))}))},t.registerUser=r,t.getUserInfo=function(){return s(this,void 0,void 0,(function(){var e,t,n;return u(this,(function(r){switch(r.label){case 0:return[4,l.StApi.get("user/info")];case 1:if(!(e=r.sent()).data.hasOwnProperty("user"))throw new Error("Wrong API response");return t=e.data.user,n=t.premium?{name:t.premium.name,expirationAt:t.premium.expiration_at,isActive:t.premium.is_active}:null,[2,{id:t.id,name:t.name,email:t.email,isEmailSubscribed:t.is_email_subscribed,isRegistered:t.is_registered,photoUrl:t.photo?t.photo.url:null,dateCreated:t.created_date,roles:t.roles,license:n}]}}))}))}}),(function(e,t,n){"use strict";var r=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})();Object.defineProperty(t,"__esModule",{value:!0});var i=n(84),o=n(85),a=n(86),s=n(90),u=n(94),c=n(95),l=n(96),f=n(97),p=n(102),d=n(106),h=n(110),v=n(118),y=n(123),g=n(124),b=n(128),w=n(132),m=n(133),_=n(134),T=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.changes=new o.default,t.collaboration=new a.default,t.collections=new s.default,t.customPlaces=new u.default,t.events=new c.default,t.favorites=new l.default,t.flights=new f.default,t.forecast=new p.default,t.pdf=new h.default,t.places=new v.default,t.hotels=new d.default,t.routes=new y.default,t.search=new g.default,t.tours=new b.default,t.trip=new w.default,t.user=new m.default,t.utility=new _.default,t}return r(t,e),t})(i.BaseSDK);t.default=T}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=(function(){return function(e){r.setEnvironment(e)}})();t.BaseSDK=i}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=(function(){function e(){}return e.prototype.initializeChangesWatching=function(e){return r.initializeChangesWatching(e)},e.prototype.stopChangesWatching=function(){return r.stopChangesWatching()},e})();t.default=i}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(87),i=(function(){function e(){}return e.prototype.followTrip=function(e){return r.followTrip(e)},e.prototype.unfollowTrip=function(e){return r.unfollowTrip(e)},e.prototype.addTripCollaboration=function(e,t,n){return r.addTripCollaboration(e,t,n)},e.prototype.getTripCollaborations=function(e){return r.getTripCollaborations(e)},e.prototype.removeTripCollaboration=function(e){return r.removeTripCollaboration(e)},e.prototype.acceptTripCollaboration=function(e,t){return r.acceptTripCollaboration(e,t)},e.prototype.resendInvitation=function(e){return r.resendInvitation(e)},e.prototype.updateTripCollaboration=function(e,t){return r.updateTripCollaboration(e,t)},e})();t.default=i}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(88);t.followTrip=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.followTrip(e)]}))}))},t.unfollowTrip=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.unfollowTrip(e)]}))}))},t.getTripCollaborations=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.getTripCollaborations(e)]}))}))},t.addTripCollaboration=function(e,t,n){return r(this,void 0,void 0,(function(){return i(this,(function(r){return[2,o.addTripCollaboration(e,t,n)]}))}))},t.removeTripCollaboration=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.removeTripCollaboration(e)]}))}))},t.acceptTripCollaboration=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){return[2,o.acceptTripCollaboration(e,t)]}))}))},t.resendInvitation=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.resendInvitation(e)]}))}))},t.updateTripCollaboration=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){return[2,o.updateTripCollaboration(e,t)]}))}))}}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(89);t.followTrip=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,o.StApi.post("trips/"+e+"/subscription",null)];case 1:return t.sent(),[2]}}))}))},t.unfollowTrip=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,o.StApi.delete_("trips/"+e+"/subscription",null)];case 1:return t.sent(),[2]}}))}))},t.getTripCollaborations=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,o.StApi.get("trips/"+e+"/collaborations")];case 1:if(!(t=n.sent()).data.hasOwnProperty("collaborations"))throw new Error("Wrong API response");return[2,a.mapTripCollaborationsApiResponseToCollaborations(t.data.collaborations)]}}))}))},t.addTripCollaboration=function(e,t,n){return r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,o.StApi.post("trip-collaborations",{trip_id:e,user_email:t,access_level:n})];case 1:return r.sent(),[2]}}))}))},t.removeTripCollaboration=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,o.StApi.delete_("/trip-collaborations/"+e,null)];case 1:return t.sent(),[2]}}))}))},t.updateTripCollaboration=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,o.StApi.put("/trip-collaborations/"+e,{access_level:t})];case 1:return n.sent(),[2]}}))}))},t.acceptTripCollaboration=function(e,t){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,o.StApi.put("/trip-collaborations/"+e+"/accept",{hash:t})];case 1:if(!(n=r.sent()).data.hasOwnProperty("collaboration"))throw new Error("Wrong API response");return[2,n.data.collaboration.trip_id]}}))}))},t.resendInvitation=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,o.StApi.post("/trip-collaborations/"+e+"/resend-email",null)];case 1:return t.sent(),[2]}}))}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapTripCollaborationsApiResponseToCollaborations=function(e){return e.map((function(e){return{id:e.id,userName:e.user_name,userEmail:e.user_email,userPhotoUrl:e.user_photo_url,accepted:e.accepted,accessLevel:e.access_level,createdAt:e.created_at,updatedAt:e.updated_at,tripId:e.trip_id}}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(31),i=(function(){function e(){}return e.prototype.getCollection=function(e,t){return r.getCollection(e,t)},e.prototype.getCollections=function(e,t,n){return r.getCollections(new r.CollectionsFilter(e),t,n)},e})();t.default=i}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(5),s=n(92);t.getCollection=function(e,t){return r(this,void 0,void 0,(function(){var n,r,u;return i(this,(function(i){switch(i.label){case 0:return[4,o.StApi.get("collections/"+e)];case 1:if(!(n=i.sent()).data.hasOwnProperty("collection"))throw new Error("Wrong API response");return r=s.mapCollectionApiResponseToCollection(n.data.collection),u=r,[4,a.getPlacesDetailed(r.placeIds,t)];case 2:return u.places=i.sent(),[2,r]}}))}))},t.getCollections=function(e,t,n){return r(this,void 0,void 0,(function(){var u,c,l=this;return i(this,(function(f){switch(f.label){case 0:return[4,o.StApi.get("collections?"+e.toQueryString())];case 1:if(!(u=f.sent()).data.hasOwnProperty("collections"))throw new Error("Wrong API response");return[4,s.mapCollectionsApiResponseToCollections(u.data.collections)];case 2:return c=f.sent(),!0!==t?[3,4]:[4,Promise.all(c.map((function(e){return r(l,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return t=e,[4,a.getPlacesDetailed(e.placeIds,n)];case 1:return t.places=r.sent(),[2]}}))}))})))];case 3:f.sent(),f.label=4;case 4:return[2,c]}}))}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapCollectionApiResponseToCollection=function(e){return r(e)},t.mapCollectionsApiResponseToCollections=function(e){return e.map((function(e){return r(e)}))};var r=function(e){var t=e.tags.map((function(e){return e}));return{id:e.id,parentPlaceId:e.parent_place_id,nameLong:e.name_long,nameShort:e.name_short,description:e.description,tags:t,placeIds:e.place_ids,places:[]}}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=(function(){function e(e){this._parentPlaceId=e.parentPlaceId,this._placeIds=e.placeIds,this._tags=e.tags,this._tagsNot=e.tagsNot,this._query=e.query,this._limit=e.limit,this._offset=e.offset,this._preferUnique=e.preferUnique}return e.prototype.toQueryObject=function(){var e={};return this._parentPlaceId&&(e.parent_place_id=this._parentPlaceId),this._placeIds&&(e.place_ids=this._placeIds.join(",")),this._tags&&(e.tags=this._tags.join(",")),this._tagsNot&&(e.tags_not=this._tagsNot.join(",")),this._query&&(e.query=this._query),this._limit&&(e.limit=this._limit),this._offset&&(e.offset=this._offset),this._preferUnique&&(e.prefer_unique=this._preferUnique),e},e.prototype.toQueryString=function(){return r.stringify(this.toQueryObject())},e})();t.CollectionsFilter=i}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=(function(){function e(){}return e.prototype.createCustomPlace=function(e){return r.createCustomPlace(e)},e.prototype.updateCustomPlace=function(e,t){return r.updateCustomPlace(e,t)},e.prototype.deleteCustomPlace=function(e){return r.deleteCustomPlace(e)},e})();t.default=i}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),i=(function(){function e(){}return e.prototype.setEventsHandler=function(e){r.setEventsHandler(e)},e})();t.default=i}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),i=(function(){function e(){}return e.prototype.addPlaceToFavorites=function(e){return r.addPlaceToFavorites(e)},e.prototype.addCustomPlaceToFavorites=function(e,t,n){return r.addCustomPlaceToFavorites(e,t,n)},e.prototype.getFavoritesIds=function(){return r.getFavoritesIds()},e.prototype.removePlaceFromFavorites=function(e){return r.removePlaceFromFavorites(e)},e})();t.default=i}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(98),i=(function(){function e(){}return e.prototype.getFlights=function(e){return r.getFlights(e)},e})();t.default=i}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(99),a=n(101);t.isOvernight=a.isOvernight,t.getFlights=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return e.adults||(e.adults=2),[2,o.getFlights(e)]}))}))}}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(29),a=n(0),s=n(1),u=n(8),c=n(100),l=8e6,f="en",p="USD",d="250km",h=null;t.getFlights=function(e){return r(this,void 0,void 0,(function(){var t,n,v,y,g,b,w,m,_,T,P;return i(this,(function(S){switch(S.label){case 0:return t=new Date(e.date),n=t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear(),v=1,s.getDistance(e.origin,e.destination,s.EARTH_RADIUS)>l&&(v=2),e.language=e.language?e.language:f,e.currency=e.currency?e.currency:p,y={partner:u.getKiwiParnerId(),flyFrom:e.origin.lat.toFixed(2)+"-"+e.origin.lng.toFixed(2)+"-"+d,to:e.destination.lat.toFixed(2)+"-"+e.destination.lng.toFixed(2)+"-"+d,dateFrom:n,dateTo:n,curr:e.currency,locale:e.language,adults:e.adults,maxstopovers:v},e.infants&&(y.infants=e.infants),e.returnDate&&(g=new Date(e.returnDate),b=g.getDate()+"/"+(g.getMonth()+1)+"/"+g.getFullYear(),y.returnFrom=b,y.returnTo=b),[4,a.KiwiApi.get("https://api.skypicker.com/flights?"+o.stringify(y))];case 1:return w=S.sent(),m=[],w.data.data.forEach((function(e){-1===m.indexOf(e.flyTo)&&m.push(e.flyTo),-1===m.indexOf(e.flyFrom)&&m.push(e.flyFrom)})),w.data.all_stopover_airports.forEach((function(e){-1===m.indexOf(e)&&m.push(e)})),_=w.data.data.sort((function(e,t){return e.route.length<t.route.length?-1:1})),(T=[]).push(function(e,t){return r(this,void 0,void 0,(function(){var n,r,s;return i(this,(function(i){switch(i.label){case 0:return n=e.map((function(e){var n={type:"id",id:e,locale:a.KiwiApi.localeMap[t]};return a.KiwiApi.get("https://locations.skypicker.com?"+o.stringify(n))})),[4,Promise.all(n)];case 1:return r=i.sent(),s=new Map,r.forEach((function(e){var t=e.data.locations[0],n={name:t.name,cityName:t.city.name,iata:t.id,location:{lat:t.location.lat,lng:t.location.lon}};s.set(t.id,n)})),[2,s]}}))}))}(m,e.language)),T.push(function(){return r(this,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:return h?[2,h]:[4,a.KiwiApi.get("https://api.skypicker.com/airlines")];case 1:return e=n.sent(),t=new Map,e.data.forEach((function(e){t.set(e.id,{id:e.id,name:e.name,logo:"https://images.kiwi.com/airlines/64/"+e.id+".png"})})),h=t,[2,t]}}))}))}()),[4,Promise.all(T)];case 2:return P=S.sent(),[2,c.mapFlights(_,e,P[0],P[1])]}}))}))}}),(function(e,t,n){"use strict";function r(e,t,n,r,o){for(var a=[],s=0;s<n.length;s++){var u=new Date,c=new Date;u.setTime(1e3*n[s].aTime),c.setTime(1e3*n[s].dTime);var l=null;a[s-1]&&(l=(c.getTime()-a[s-1].arrivalTime.getTime())/1e3),a.push({origin:r.get(n[s].flyFrom),destination:r.get(n[s].flyTo),flightNo:n[s].flight_no,airline:o.get(n[s].airline),polyline:i.encode([[n[s].latFrom,n[s].lngFrom],[n[s].latTo,n[s].lngTo]]),arrivalTime:u,departureTime:c,stopOver:l})}return{origin:r.get(e[0]),destination:r.get(e[1]),duration:t,routes:a}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(32);t.mapFlights=function(e,t,n,i){return e.map((function(e){var o=null;return e.routes[1]&&(o=r(e.routes[1],e.duration.return,e.route.filter((function(e){return e.return})),n,i)),{outbound:r(e.routes[0],e.duration.departure,e.route.filter((function(e){return!e.return})),n,i),price:e.price,currency:t.currency,deepLink:e.deep_link,inbound:o}}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOvernight=function(e){var t=e.routes[0].departureTime,n=e.routes[e.routes.length-1].arrivalTime;return t.getDay()!==n.getDay()}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(103),i=(function(){function e(){}return e.prototype.getDestinationWeather=function(e){return r.getDestinationWeather(e)},e})();t.default=i}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(104);t.getDestinationWeather=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.getDestinationWeather(e)]}))}))}}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(105);t.getDestinationWeather=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,o.StApi.get("places/"+e+"/weather-forecast")];case 1:if(!(t=n.sent()).data.hasOwnProperty("forecast"))throw new Error("Wrong API response");return[2,a.mapForecastsApiResponseToForecasts(t.data.forecast)]}}))}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.mapForecastsApiResponseToForecasts=function(e){return e.map((function(e){return r.camelizeKeys(e)}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(107),i=(function(){function e(){}return e.prototype.getHotels=function(e){return r.getHotels(new r.HotelsFilter(e))},e})();t.default=i}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(108),a=n(109);t.HotelsFilter=a.HotelsFilter,t.getHotels=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.getHotels(e)]}))}))}}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),a=n(0),s=n(18);t.getHotels=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return e.bounds&&e.zoom&&(e=e.switchBoundsToMapTileBounds()),[4,a.StApi.get("hotels/list/?"+e.toQueryString())];case 1:if(!(t=r.sent()).data.hasOwnProperty("hotels"))throw new Error("Wrong API response");return n=t.data.hotels.map((function(e){return{place:s.mapPlace(e.place,null),bookingCom:o.camelizeKeys(e.booking_com)}})),[2,{hotels:n,hotelFacilities:t.data.hotel_facilities,roomFacilities:t.data.room_facilities}]}}))}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=n(1),o=(function(){function e(e){this._checkIn=e.checkIn,this._checkOut=e.checkOut,this._adults=e.adults,this._children=e.children,this._maxPrice=e.maxPrice,this._minPrice=e.minPrice,this._minReviewScore=e.minReviewScore,this._bounds=e.bounds,this._placeIds=e.placeIds,this._mapTileBounds=e.mapTileBounds,this._stars=e.stars,this._currency=e.currency,this._propertyTypes=e.propertyTypes,this._hotelFacilities=e.hotelFacilities,this._roomFacilities=e.roomFacilities,this._limit=e.limit,this._zoom=e.zoom,this.validate()}return Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom?this._zoom:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bounds",{get:function(){return this._bounds?this._bounds:null},enumerable:!0,configurable:!0}),e.prototype.toQueryObject=function(){var e={check_in:this._checkIn,check_out:this._checkOut,adults:this._adults};return this._children&&(e.children=this._children.join(",")),this._maxPrice&&(e.max_price=this._maxPrice),this._minPrice&&(e.min_price=this._minPrice),this._minReviewScore&&(e.min_review_score=this._minReviewScore),this._placeIds&&(e.place_ids=this._placeIds.join("|")),this._bounds&&(e.bounds=this._bounds.south+","+this._bounds.west+","+this._bounds.north+","+this._bounds.east),this._mapTileBounds&&(e.map_tile_bounds=this._mapTileBounds.join(",")),this._stars&&(e.stars=this._stars.join("|")),this._currency&&(e.currency=this._currency),this._propertyTypes&&(e.property_types=this._propertyTypes.join("|")),this._hotelFacilities&&(e.hotel_facilities=this._hotelFacilities.join(",")),this._roomFacilities&&(e.room_facilities=this._roomFacilities.join(",")),this._limit&&(e.limit=this._limit),e},e.prototype.toQueryString=function(){return r.stringify(this.toQueryObject())},e.prototype.switchBoundsToMapTileBounds=function(){var e=Object.create(this);if(!this._bounds||!this._zoom)return Object.assign(e,this,{_mapTileBounds:null});var t=i.locationToMapTileKey({lat:this._bounds.south,lng:this._bounds.west},this._zoom),n=i.locationToMapTileKey({lat:this._bounds.north,lng:this._bounds.east},this._zoom);return Object.assign(e,this,{_bounds:null,_mapTileBounds:[t,n]})},e.prototype.validate=function(){if(!this._adults)throw new Error("Adults count is mandatory.");if(1!==[this._bounds,this._mapTileBounds,this._placeIds].filter((function(e){return e})).length)throw new Error("Bounds, mapTileBounds and places have to be used exclusively and one of them has to be present.");var e=new Date(this._checkIn),t=new Date(this._checkOut);if("Invalid Date"===e.toString())throw new Error("Invalid checkIn date.");if("Invalid Date"===t.toString())throw new Error("Invalid checkOut date.");if(t<=e)throw new Error("Invalid checkIn/checkOut combination.")},e})();t.HotelsFilter=o}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(111),a=(function(){function e(){}return e.prototype.getPdfData=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.getPdfData(e)]}))}))},e.prototype.generatePdf=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.generatePdf(e)]}))}))},e})();t.default=a}),(function(e,t,n){"use strict";function r(e){return o(this,void 0,void 0,(function(){var t,n,r,s,l,f,d;return a(this,(function(h){switch(h.label){case 0:return[4,c.getPlacesDestinationMap(Array.from(e.keys()),g)];case 1:return t=h.sent(),n=new Map,r=new Map,s=new Map,t.forEach((function(t,i){if(s.set(i,y.PlaceSource.FROM_TRIP),n.has(t.id)||n.set(t.id,t),r.has(t.id)){var o=r.get(t.id);o.push(e.get(i)),r.set(t.id,o)}else r.set(t.id,[e.get(i)])})),f=c.getPlacesDetailedMap,[4,u.getFavoritesIds()];case 2:return[4,f.apply(void 0,[h.sent(),g])];case 3:return l=h.sent(),[4,c.getPlacesDestinationMap(Array.from(l.keys()),g)];case 4:return h.sent().forEach((function(e,t){if(e&&r.has(e.id)){s.set(t,y.PlaceSource.FROM_FAVORITES);var n=l.get(t),i=r.get(e.id);r.set(e.id,c.mergePlacesArrays(i,[n]))}})),d=[{}],[4,(function(e,t){return o(this,void 0,void 0,(function(){var n,r,i,s;return a(this,(function(u){switch(u.label){case 0:return[4,p.getUserSettings()];case 1:return n=u.sent(),[4,(function(e){return o(this,void 0,void 0,(function(){var t,n;return a(this,(function(r){switch(r.label){case 0:return e?[4,c.getPlacesDestinationMap([e],g)]:[2,null];case 1:return t=r.sent(),n=t.get(e),[2,n?n.id:null]}}))}))})(n.homePlaceId)];case 2:return r=u.sent(),i=r?t.get(r):void 0,r&&i&&i.length>1&&(e.delete(r),t.delete(r)),s=[],t.forEach((function(e,t){if(1===e.length){var n=e[0],r=n.detail.tags.find((function(e){return"Airport"===e.name}));r&&s.push(t)}})),s.forEach((function(n){e.delete(n),t.delete(n)})),[2,{destinationIdsWithDestinations:e,destinationIdsWithPlaces:t}]}}))}))})(n,r)];case 5:return[2,i.apply(void 0,d.concat([h.sent(),{placeIdsWithPlaceType:s}]))]}}))}))}var i=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(31),u=n(17),c=n(5),l=n(12),f=n(10),p=n(4),d=n(6),h=n(33),v=n(116),y=n(117),g="150x120",b=5e3,w=60;t.generatePdf=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return a(this,(function(i){switch(i.label){case 0:return[4,h.generatePdf(e)];case 1:if("generating"!==(t=i.sent()).state)return[2,t];n=0,i.label=2;case 2:return n<w?(n++,[4,d.sleep(b)]):[3,5];case 3:return i.sent(),[4,h.getGeneratingState(e,t.generatingId)];case 4:return"generating"!==(r=i.sent()).state?[2,r]:[3,2];case 5:return[2,{generatingId:t.generatingId,state:"timeout",url:null}]}}))}))},t.getPdfData=function(e){return o(this,void 0,void 0,(function(){var t,n,i,u,p,d,h,b,w,m,_,T,P;return a(this,(function(S){switch(S.label){case 0:return[4,f.getTripDetailed(e.tripId)];case 1:if(t=S.sent(),n={destinations:[],routes:[]},!t.days)throw new Error("Can't generate PDF data for trip without days");return i=Promise.all(t.days.map((function(e,n){return l.getRoutesForTripDay(t.id,n)}))),[4,c.getPlacesMapFromTrip(t,g)];case 2:return u=S.sent(),[4,r(u)];case 3:return p=S.sent(),d=p.destinationIdsWithDestinations,h=p.destinationIdsWithPlaces,b=p.placeIdsWithPlaceType,w=Array.from(h.keys()),m=Promise.all(w.map((function(t){return (function(e,t,n,r,i){return o(this,void 0,void 0,(function(){var u,l,f,p,d;return a(this,(function(h){switch(h.label){case 0:return[4,s.getCollectionsForDestinationId(e,g)];case 1:return u=h.sent(),(l=c.mergePlacesArrays(function(e){if(0===e.length)return[];var t=[];return e.forEach((function(n){0===n.tags.length&&(t=e[0].places)})),t}(u),t.get(e))).filter((function(e){return!r.has(e.id)})).forEach((function(e){r.set(e.id,y.PlaceSource.FROM_COLLECTION)})),t.set(e,l),[4,(function(e,t){return o(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(o){switch(o.label){case 0:return[4,v.generateDestinationMainMap(e,t)];case 1:return n=o.sent(),r=n.sectors.filter((function(e){return e.places.length>5})),[4,v.generateDestinationSecondaryMaps(e,t,r)];case 2:return i=o.sent(),[2,{mainMap:n,secondaryMaps:i}]}}))}))})(l,i)];case 2:return f=h.sent(),p=f.mainMap,d=f.secondaryMaps,[2,{destination:n.get(e),places:t.get(e),placeSources:r,mainMap:p,secondaryMaps:d}]}}))}))})(t,h,d,b,e)}))),[4,Promise.all([i,m])];case 4:return _=S.sent(),T=_[0],P=_[1],n.routes=T,n.destinations=P,[2,n]}}))}))},t.buildDestinationsAndPlaces=r}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),a=n(0),s=n(9),u=n(113);t.getRoutes=function(e){return r(this,void 0,void 0,(function(){var t,n,l,f;return i(this,(function(p){switch(p.label){case 0:return t=e.map(c),[4,s.routesCache.getBatchMap(t)];case 1:return n=p.sent(),l=t.map((function(e){return n.get(e)})),[4,(function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.map((function(e){return{origin:e.origin,destination:e.destination,waypoints:e.waypoints,avoid:e.avoid}})),[4,a.StApi.post("/directions/path",t)];case 1:return(n=r.sent()).data.path.map((function(t,n){s.routesCache.set(c(e[n]),t)})),[2,n.data.path]}}))}))})(e.filter((function(e,t){return!l[t]})))];case 2:return f=p.sent(),[2,l.map((function(e){return null===e?f.shift():e})).map((function(t,n){var r=o.Mapper.mapRouteFromApiResponse(t,e[n].avoid,e[n].chosenMode);return r.modeDirections.push({mode:"plane",directions:[u.estimatePlaneDirection(r.origin,r.destination)]}),r.chosenDirection=o.Mapper.chooseDirection(r.modeDirections,e[n].chosenMode,e[n].routeId),r}))]}}))}))};var c=function(e){var t=[];return t.push(e.origin.lat.toString()),t.push(e.origin.lng.toString()),t.push(e.destination.lat.toString()),t.push(e.destination.lng.toString()),t.push(e.avoid.join("-")),e.waypoints&&t.push(e.waypoints.map((function(e){return e.location.lat.toString()+"-"+e.location.lng.toString()})).join("-")),t.join("-")}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(32),i=n(1);t.estimatePlaneDirection=function(e,t){var n=i.getDistance(e,t,i.EARTH_RADIUS);return{distance:n,duration:Math.round(n/900*3.6+7200),polyline:r.encode([[e.lat,e.lng],[t.lat,t.lng]]),mode:"plane",type:"fastest",avoid:[],source:"estimator",isoCodes:[],routeId:null}}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(12),o={driving:"car",walking:"pedestrian"},a=["plane","car","pedestrian"];t.mapRouteFromApiResponse=function(e,n,i){var s=r.camelizeKeys(e);s.directions=s.directions.map((function(e){return e.mode=o[e.mode]?o[e.mode]:e.mode,e.avoid||(e.avoid="car"===e.mode?n:[]),e})),s.modeDirections=s.directions.reduce((function(e,t){var n=e.find((function(e){return e.mode===t.mode}));return n||(n={mode:t.mode,directions:[]},e.push(n)),n.directions.push(t),e}),[]).sort((function(e,t){var n=a.indexOf(e.mode),r=a.indexOf(t.mode);return n<r?1:n>r?-1:0})),delete s.directions;var u=s;return u.chosenDirection=t.chooseDirection(u.modeDirections,i),u},t.createRouteRequest=function(e,t,n,r,o,a){return void 0===n&&(n=null),{origin:t,destination:e,waypoints:r||[],avoid:o||["unpaved"],chosenMode:a||i.ModeSelector.selectOptimalMode(t,e),routeId:n}},t.chooseDirection=function(e,t,n){void 0===n&&(n=null);for(var r=null,i=0,o=e;i<o.length;i++){var a=o[i];if((null===r||a.mode===t&&!n)&&(r=a.directions[0]),a.mode===t&&n){var s=a.directions.find((function(e){return n===e.routeId}));s&&(r=s)}}return r}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.selectOptimalMode=function(e,t){var n=r.getDistance(e,t,r.EARTH_RADIUS);return n<=2e3?"pedestrian":n<=1e6?"car":"plane"},t.getAvailableModes=function(e,t){var n=r.getDistance(e,t,r.EARTH_RADIUS),i=[];return n<=5e4&&i.push("pedestrian"),n<=2e6&&i.push("car"),n>5e4&&i.push("plane"),i}}),(function(e,t,n){"use strict";function r(e,t,n){for(var r=e.north,i=e.west,o=(e.east-e.west)/t,a=(e.north-e.south)/n,s=[],u=0;u<n;u++)for(var c=0;c<t;c++){var l={south:r-(u+1)*a,west:i+c*o,north:r-u*a,east:i+(c+1)*o};s.push({id:String.fromCharCode(97+u).toUpperCase()+c.toString(),bounds:l,places:[]})}return s}var i=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),u=n(33);t.generateDestinationMainMap=function(e,t){return o(this,void 0,void 0,(function(){var n,o,c;return a(this,(function(a){switch(a.label){case 0:return n=e.map((function(e){return e.location})),[4,u.getStaticMap(t.mainMapWidth,t.mainMapHeight,n)];case 1:return o=a.sent(),(c=r(o.bounds,t.gridColumnsCount,t.gridRowsCount)).forEach((function(t){t.places=e.filter((function(e){return s.isLocationInBounds(e.location,t.bounds)}))})),c=c.filter((function(e){return e.places.length>0})),[2,i({},o,{id:"main",sectors:c})]}}))}))},t.generateDestinationSecondaryMaps=function(e,t,n){return o(this,void 0,void 0,(function(){var r=this;return a(this,(function(s){return[2,Promise.all(n.map((function(n){return o(r,void 0,void 0,(function(){var r,o;return a(this,(function(a){switch(a.label){case 0:return r=n.places.map((function(t){return e.find((function(e){return e.id===t.id}))})),[4,u.getStaticMap(t.secondaryMapWidth,t.secondaryMapHeight,r.map((function(e,t){return{lat:e.location.lat,lng:e.location.lng,image:"http://a.twobits.cz/i/1x/b/"+(t+1)+".png"}})))];case 1:return o=a.sent(),[2,i({},o,{id:n.id,sectors:[]})]}}))}))})))]}))}))},t.calculateMapGrid=r}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!(function(e){e.FROM_TRIP="FROM_TRIP",e.FROM_COLLECTION="FROM_COLLECTION",e.FROM_FAVORITES="FROM_FAVORITES"})(t.PlaceSource||(t.PlaceSource={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=n(119),o=n(121),a=(function(){function e(){}return e.prototype.getPlaces=function(e){return r.getPlaces(new r.PlacesListFilter(e))},e.prototype.getPlaceDetailed=function(e,t){return r.getPlaceDetailed(e,t)},e.prototype.getPlacesDetailed=function(e,t){return r.getPlacesDetailed(e,t)},e.prototype.getPlaceMedia=function(e){return r.getPlaceMedia(e)},e.prototype.getPlacesStats=function(e){return r.getPlacesStats(new r.PlacesStatsFilter(e))},e.prototype.getPlaceGeometry=function(e){return r.getPlaceGeometry(e)},e.prototype.getPlaceOpeningHours=function(e,t,n){return r.getPlaceOpeningHours(e,t,n)},e.prototype.detectParentsByBounds=function(e,t){return r.detectParentsByBounds(e,t)},e.prototype.detectParentsByLocation=function(e){return r.detectParentsByLocation(e)},e.prototype.addPlaceReview=function(e,t,n){return r.addPlaceReview(e,t,n)},e.prototype.deletePlaceReview=function(e){return r.deletePlaceReview(e)},e.prototype.getPlaceReviews=function(e,t,n){return r.getPlaceReviews(e,t,n)},e.prototype.voteOnReview=function(e,t){return r.voteOnReview(e,t)},e.prototype.spreadPlacesOnMap=function(e,t,n,r){return i.spread(e,t,n,r)},e.prototype.spreadPlacesOnMapV2=function(e,t,n,r,i,a){return o.spread(e,t,n,r,i,a)},e.prototype.getPlacesDestinationMap=function(e,t){return r.getPlacesDestinationMap(e,t)},e})();t.default=a}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(34);t.getConfig=r.getConfig;var i=n(34),o=n(120);t.spread=function(e,t,n,r){return r||(r=i.getConfig(t,n)),o.spread(e,r,t,n)}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.spread=function(e,t,n,r){return e.reduce((function(e,o){return i(e,o,t,n,r)}),{hidden:[],visible:[]})};var i=function(e,t,n,i,a){if(!t.location)return e.hidden.push(t),e;for(var s=r.locationToCanvasCoordinate(t.location,i,a),u=0,c=n;u<c.length;u++){var l=c[u];if((!l.photoRequired||t.thumbnailUrl)&&!(l.minimalRating&&t.rating<=l.minimalRating||o(l,s,e.visible)))return e.visible.push({place:t,coordinate:s,size:l}),e}return e.hidden.push(t),e},o=function(e,t,n){for(var r,i=e.radius,o=0,a=n;o<a.length;o++){var s=a[o],u=e.margin>s.size.margin?e.margin:s.size.margin;if(r=s.size.radius,Math.pow(t.x-s.coordinate.x,2)+Math.pow(t.y-s.coordinate.y,2)<=Math.pow(i+r+u,2))return!0}return!1}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(35),i=n(122);t.spread=function(e,t,n,o,a,s){return a||(a=r.getSizesConfig()),s||null===s||(s=r.getCategoriesConfig()),i.spread(e,t,a,n,o,s)}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(35);t.spread=function(e,t,n,i,a,s){var u=r.getZoomFromBounds(i,a.width),c=t.reduce((function(e,t){return o(e,t,n,i,a,u,!0)}),{hidden:[],visible:[]});return e.reduce((function(e,t){return o(e,t,n,i,a,u,!1,s)}),c)};var o=function(e,t,n,o,s,u,c,l){var f=t.rating;if(l&&"poi"===t.level&&(f=t.rating*i.getRatingCoeficientFromCategories(l,t.categories)),!t.location)return e.hidden.push(t),e;for(var p=r.locationToCanvasCoordinate(t.location,o,s),d=0,h=n;d<h.length;d++){var v=h[d];if(!v.photoRequired||t.thumbnailUrl){var y=v.zoomLevelLimits[u-1]?v.zoomLevelLimits[u-1]:v.zoomLevelLimits[v.zoomLevelLimits.length-1];if(!(y&&f<y)&&(c||"poi"!==t.level||!i.isDisabledByCategory(v.disabledCategories,t.categories))&&!a(v,p,e.visible))return e.visible.push({place:t,coordinate:p,size:v}),e}}return e.hidden.push(t),e},a=function(e,t,n){for(var r,i=e.radius,o=0,a=n;o<a.length;o++){var s=a[o],u=e.margin>s.size.margin?e.margin:s.size.margin;if(r=s.size.radius,Math.pow(t.x-s.coordinate.x,2)+Math.pow(t.y-s.coordinate.y,2)<=Math.pow(i+r+u,2))return!0}return!1}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),i=(function(){function e(){}return e.prototype.getRoutesForTripDay=function(e,t){return r.getRoutesForTripDay(e,t)},e.prototype.getDirections=function(e,t,n,i){return r.getDirections(e,t,n,i)},e})();t.default=i}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(125),i=(function(){function e(){}return e.prototype.search=function(e,t){return r.search(e,t)},e.prototype.searchReverse=function(e){return r.searchReverse(e)},e.prototype.searchTags=function(e){return r.searchTags(e)},e})();t.default=i}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(126);t.search=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){return[2,o.search(e,t)]}))}))},t.searchReverse=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.searchReverse(e)]}))}))},t.searchTags=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.searchTags(e)]}))}))}}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=n(0),s=n(127);t.search=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return n=t?o.stringify({query:e,location:[t.lat,t.lng].join(",")}):o.stringify({query:e}),[4,a.StApi.get("search?"+n)];case 1:if(!(r=i.sent()).data.hasOwnProperty("locations"))throw new Error("Wrong API response");return[2,s.mapSearchApiResponseToSearchResults(r.data.locations)]}}))}))},t.searchReverse=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=o.stringify({location:[e.lat,e.lng].join(",")}),[4,a.StApi.get("search/reverse?"+t)];case 1:if(!(n=r.sent()).data.hasOwnProperty("locations"))throw new Error("Wrong API response");return[2,s.mapSearchApiResponseToSearchResults(n.data.locations)]}}))}))},t.searchTags=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,a.StApi.get("tags?"+o.stringify({query:e}))];case 1:if(!(t=n.sent()).data.hasOwnProperty("tags"))throw new Error("Wrong API response");return[2,s.mapSearchTagsApiResponseToTags(t.data.tags)]}}))}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(18);t.mapSearchApiResponseToSearchResults=function(e){return e.map((function(e){return{location:r.camelizeKeys(e.location),type:e.type,distance:e.distance,address:r.camelizeKeys(e.address),place:e.place?i.mapPlaceDetailedApiResponseToPlace(e.place,"150x150"):null}}))},t.mapSearchTagsApiResponseToTags=function(e){return e.map((function(e){return r.camelizeKeys(e)}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),i=(function(){function e(){}return e.prototype.getTours=function(e){return r.getTours(e)},e})();t.default=i}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(130);t.getTours=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,o.getTours(e)]}))}))}}),(function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return (function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}})([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=n(0),s=n(131);t.getTours=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,a.StApi.get("tours/viator?"+o.stringify({parent_place_id:e.parentPlaceId,page:e.page,sort_by:e.sortBy,sort_direction:e.sortDirection}))];case 1:if(!(t=n.sent()).data.hasOwnProperty("tours"))throw new Error("Wrong API response");return[2,s.mapToursApiResponseToTours(t.data.tours)]}}))}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapToursApiResponseToTours=function(e){return e.map((function(e){return{id:e.id,supplier:e.supplier,title:e.title,perex:e.perex,url:e.url,rating:e.rating,reviewCount:e.review_count,photoUrl:e.photo_url,price:e.price,originalPrice:e.original_price,duration:e.duration}}))}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=(function(){function e(){}return e.prototype.getTrips=function(e,t){return r.getTrips(e,t)},e.prototype.getTripsInTrash=function(){return r.getTripsInTrash()},e.prototype.getTripDetailed=function(e){return r.getTripDetailed(e)},e.prototype.createTrip=function(e,t,n,i){return r.createTrip(e,t,n,i)},e.prototype.updateTrip=function(e,t){return r.updateTrip(e,t)},e.prototype.cloneTrip=function(e){return r.cloneTrip(e)},e.prototype.ensureTripSyncedToServer=function(e){return r.ensureTripSyncedToServer(e)},e.prototype.addDaysToTrip=function(e,t,n){return r.addDaysToTrip(e,t,n)},e.prototype.removeDayFromTrip=function(e,t){return r.removeDayFromTrip(e,t)},e.prototype.swapDaysInTrip=function(e,t,n){return r.swapDaysInTrip(e,t,n)},e.prototype.movePlaceInDay=function(e,t,n,i){return r.movePlaceInDay(e,t,n,i)},e.prototype.removePlacesFromDay=function(e,t,n){return r.removePlacesFromDay(e,t,n)},e.prototype.removePlaceFromDaysByPlaceId=function(e,t,n){return r.removePlaceFromDaysByPlaceId(e,t,n)},e.prototype.removeAllPlacesFromDay=function(e,t){return r.removeAllPlacesFromDay(e,t)},e.prototype.addPlaceToDay=function(e,t,n,i){return r.addPlaceToDay(e,t,n,i)},e.prototype.addSequenceToDay=function(e,t,n,i,o){return r.addSequenceToDay(e,t,n,i,o)},e.prototype.setOvernightPlace=function(e,t,n){return r.setOvernightPlace(e,t,n)},e.prototype.setTransport=function(e,t,n,i){return r.setTransport(e,t,n,i)},e.prototype.emptyTripsTrash=function(){return r.emptyTripsTrash()},e.prototype.getTripTemplates=function(e){return r.getTripTemplates(e)},e.prototype.applyTripTemplate=function(e,t,n){return r.applyTripTemplate(e,t,n)},e.prototype.updateItineraryItemUserData=function(e,t,n,i,o,a){return r.updateItineraryItemUserData(e,t,n,i,o,a)},e.prototype.updateDayNote=function(e,t,n){return r.updateDayNote(e,t,n)},e})();t.default=i}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=(function(){function e(){}return e.prototype.setUserSession=function(e){return r.setUserSession(e)},e.prototype.getUserSession=function(){return r.getUserSession()},e.prototype.getUserSettings=function(){return r.getUserSettings()},e.prototype.updateUserSettings=function(e){return r.updateUserSettings(e)},e.prototype.loginUserWithDeviceId=function(e,t){return r.loginUserWithDeviceId(e,t)},e.prototype.loginUserWithJwt=function(e,t,n){return r.loginUserWithJwt(e,t,n)},e.prototype.loginUserWithPassword=function(e,t,n,i){return r.loginUserWithPassword(e,t,n,i)},e.prototype.loginUserWithFacebook=function(e,t,n,i){return r.loginUserWithFacebook(e,t,n,i)},e.prototype.loginUserWithGoogle=function(e,t,n,i){return r.loginUserWithGoogle(e,t,n,i)},e.prototype.registerUser=function(e,t,n){return r.registerUser(e,t,n)},e.prototype.getUserInfo=function(){return r.getUserInfo()},e})();t.default=i}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=(function(){function e(){}return e.prototype.locationToMapTileKey=function(e,t){return r.locationToMapTileKey(e,t)},e})();t.default=i})])}));